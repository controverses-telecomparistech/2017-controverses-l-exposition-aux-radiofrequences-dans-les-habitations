/**
 * Package www/element
 * lmd/module/element/bootstrap
 * lmd/ui/iframe-fit-content
 * lmd/module/element/toolbar
 * lmd/ui/form/compteur-input
 * hgn/www/partials/element/toolbar.html.mu.js@abs
 * lmd/module/element/reaction
 * lmd/ui/lecture-zen
 * lmd/module/portfolio
 */

/* -- start module lmd/module/element/bootstrap -- */
define("lmd/module/element/bootstrap",function(require){"use strict";var $=require("jquery"),t=require("lmd/module/element/toolbar"),o=(require("lmd/module/element/reaction"),require("lmd/core/social/facebook")),e=require("lmd/core/context"),i=require("lmd/module/element/tracking"),n={init:function(n){n.toolbar.context=e,t.init(n.toolbar),null===document.querySelector(".rubrique_marque")&&i.attachXitiEvent(".js_article_body"),$("figcaption[data-caption]").each(function(){var t=$(this).find("[data-copyright]");t.text(t.data("copyright")),$(this).html($(this).data("caption")+" "+$(this).html())}),$("span#publisher").text($("span#publisher").data("source")),$(".illustration_haut").hover(function(){$("figcaption",this).stop(!0,!0).slideDown("fast")},function(){$("figcaption",this).stop(!0,!0).slideUp("fast")}),"undefined"==typeof n.facebook&&(n.facebook={}),lmd.onload(function(){o.load().done(function(){o.parse(n.facebook)})})}};return n});
/* -- end module lmd/module/element/bootstrap -- */
/* -- start module lmd/ui/iframe-fit-content -- */
define("lmd/ui/iframe-fit-content",function(require){"use strict";function e(e){$(e).ready(function(){var i=parseInt(e.style.height||e.height),r=e.contentWindow.document.body,o=document.createElement("script");o.src=t,r.appendChild(o),(isNaN(i)||i<100)&&n({},e)})}var $=require("jquery"),i=require("lmd/core/conf"),n=require("lib/iframe-resizer/iframeResizer"),t=i.medias.location.base_url_version+"/js/lib/iframe-resizer/js/iframeResizer.contentWindow.min.js",r={init:function(i,n){var t,r=document.getElementById(i);void 0!==n&&(t=r.getElementsByClassName(n),Array.prototype.forEach.call(t,function(i){e(i)}))}};return r});
/* -- end module lmd/ui/iframe-fit-content -- */
/* -- start module lmd/module/element/toolbar -- */
define("lmd/module/element/toolbar",function(require){"use strict";var $=require("jquery"),e=require("lmd/core/conf"),i=require("lmd/core/context"),t=require("lmd/core/auth"),n=require("lmd/core/social/facebook"),o=require("hoganpower!/partials/element/toolbar.html.mu"),r=require("lib/object-path"),s=require("lmd/module/xiti/hit"),a=require("lmd/ui/sharing");return require("lib/jquery/plugin/jquery.spin"),{_renderDeferred:null,$el:null,_options:null,render:function(){return null===this._renderDeferred&&(this._renderDeferred=$.Deferred(),t.loadUser().done($.proxy(function(){a.getFacebookLikes().done($.proxy(function(e){e=e>0&&a.formatCounter(e);var i={facebook_likes:e};void 0!==this._options.aboLabel&&(i.aboLabel=this._options.aboLabel),void 0!==this._options.loginPartial&&(i.loginPartial=this._options.loginPartial),this.$el=$(o.render(i)),this._initSharing(),this._initEnvoyer(),this._initImprimer(),this._initClasser(),this._initReagir(),this._initAbonnezVous(),this._renderDeferred.resolve()},this))},this))),this._renderDeferred.promise()},_initSharing:function(e){var i,t=this;this.$el.find(".partage .facebook").click(function(o){i=e||t._getPageUrl("",!1),n.load().done(function(){FB.ui({method:"feed",link:i,picture:""})}),t._xtSocial(o.currentTarget,".partage .facebook","Facebook")}),this.$el.find(".partage .twitter").click(function(n){var o="http://twitter.com/share?related=lemondefr&lang=fr&text=",s=$("<div />").html(t._options.context.item.titre).text(),a="",l=o+encodeURIComponent(s),c={width:550,height:443};r.get("context.item.partenaire")||(a="&via=lemondefr"),i=e||t._getPageUrl("AL-32280258",!0),l+=a+"&url="+i,t._openPopupShare(l,c),t._xtSocial(n.currentTarget,".partage .twitter","Twitter")})},_openPopupShare:function(e,i){var t="undefined"!=typeof i.width?i.width:650,n="undefined"!=typeof i.height?i.height:430,o=($(window).width()-t)/2,r=($(window).height()-n)/2,s="";s="width="+t+",height="+n+",top="+r+",left="+o,s+=",location=no,resizable=yes,status=no,titlebar=no,toolbar=no",window.open(e,"toolbar_share_popup",s)},_xtSocial:function(e,i,t){var n=r.get(this._options,"context.item.titre");if(n){var o="Partage::"+t+"::"+n,s=this._getPosition($(e).parents(".toolbar"));s&&(o+="::"+s),this._xtClick(e,!1,o,"A")}},_xtClick:function(e,i,t,n){"undefined"==typeof n&&(n="A");var o=i?this._options.context.page.xiti.xtn2:"";return s.hit(e,"C",o,t,n),!1},_getPosition:function(e){if($(".contenu_article").length)return $(e).nextAll(".contenu_article").length>0?"Top":"Bottom"},_initEnvoyer:function(){if("undefined"==typeof this._options.envoyer||"undefined"!=typeof this._options.envoyer.active&&this._options.envoyer.active===!1)return void this.$el.find(".outil_envoyer").hide();var e=this;this.$el.find(".outil_envoyer").on("click",function(i){e._xtClick(i.currentTarget,!0,"Clic_Envoyer"),window.open(e._options.envoyer.link,"_blank")})},_initImprimer:function(){if("undefined"==typeof this._options.imprimer||void 0!==this._options.imprimer.active&&this._options.imprimer.active===!1||void 0!==i.item&&void 0!==i.item.type&&void 0!==i.item.type.nom&&("video"===i.item.type.nom||"portfolio"===i.item.type.nom))return void this.$el.find(".outil_imprimer").hide();var e=this;this.$el.find(".outil_imprimer").click(function(i){e._xtClick(i.currentTarget,!0,"Clic_Imprimez"),window.print()})},_initClasser:function(){return"undefined"!=typeof this._options.classer&&"undefined"!=typeof this._options.classer.active&&this._options.classer.active===!1?void this.$el.find(".outil.classer").hide():(t.authenticated&&t.user&&t.user.abonne&&this._checkFav(),this.$el.find(".outil.classer").click($.proxy(this._onClickClasser,this)),void this.$el.find(".confirmation .fermer").click(function(){$(this).parents(".confirmation").hide()}))},_onClickClasser:function(e){var i=$(e.currentTarget).parents(".toolbar");return this._xtClick(e.currentTarget,!0,"Clic_Classer"),t.authenticated&&t.user&&t.user.abonne?void this._toggleFav(i):(i.find(".teaser .non_abo.classer").is(":visible")?i.find(".teaser").hide():i.find(".teaser").show(),i.find(".teaser .non_abo").hide(),void i.find(".teaser .non_abo.classer").show())},_checkFav:function(){if(null!==t.user.newId){var e="/sfuser/sfws/user/classeur/has/$1",i=encodeURIComponent(t.user.newId);e=e.replace("$1",this._options.context.item.cms_id),$.get(e,"userId="+i,null,"json").done(function(e){"undefined"!=typeof e&&""!==e&&e.success===!0&&$(".toolbar .outil.classer").addClass("actif")})}else{var n,e="/api/1/user/classer/$1/$2/$3.html",i=t.user.id+"",o={};e=e.replace("$1",i[i.length-1]),e=e.replace("$2",i[i.length-2]),e=e.replace("$3",i),o.mode="has_elem",o.item_id=this._options.context.item.id,n="params="+JSON.stringify(o),$.get(e,n,null,"json").done(function(e){"undefined"!=typeof e&&""!==e&&"1"===e.result&&$(".toolbar .outil.classer").addClass("actif")})}},_toggleFav:function(e){e.find(".confirmation").hide();var i,t=$(".toolbar");t.find(".outil.classer").hasClass("actif")?(this._callToggleFavApi("unsubscribe"),t.find(".outil.classer").removeClass("actif"),i="Cet élément a bien été supprimé de vos favoris."):(this._callToggleFavApi("subscribe"),t.find(".outil.classer").addClass("actif"),i="Cet élément a bien été ajouté à vos favoris."),e.find(".confirmation .message").html(i).show(),e.find(".confirmation").show()},_callToggleFavApi:function(e){if(null!=t.user.newId){var i="/sfuser/sfws/user/classeur/"+e+"/$1",n=encodeURIComponent(t.user.newId);i=i.replace("$1",this._options.context.item.cms_id),$.get(i,"userId="+n,null,"json").done($.proxy(t.refresh,t))}else{var o,r={};r.mode="add_elem",r.item_id=this._options.context.item.id,o="params="+JSON.stringify(r),$.get("/api/1/user/classeur/",o,null,"json").done($.proxy(t.refresh,t))}},_initReagir:function(){return"undefined"!=typeof this._options.reagir&&"undefined"!=typeof this._options.reagir.active&&this._options.reagir.active===!1?void this.$el.find(".outil.reagir").hide():void this.$el.find(".outil.reagir").on("click",$.proxy(this._onClickReagir,this))},_onClickReagir:function(e){$(e.currentTarget).parents(".toolbar"),this._xtClick(e.currentTarget,!0,"Clic_Reagir"),"undefined"!=typeof this._options.reagir&&"undefined"!=typeof this._options.reagir.link&&window.open(this._options.reagir.link,"_blank")},_initAbonnezVous:function(){if(!("undefined"!=typeof this._options.abonnez_vous&&"undefined"!=typeof this._options.abonnez_vous.active&&this._options.abonnez_vous.active===!1||t.authenticated&&t.user&&t.user.abonne)){var i=this;this.$el.find(".barre_outils .bt_abo, .teaser .btn_abo").click(function(t){var n=$(t.currentTarget).parents(".toolbar"),o=$(n).nextAll(".contenu_article").length>0?"haut":"bas",r="BARRE_OUTIL_ARTICLE_"+o.toUpperCase();i._xtClick(t.currentTarget,!1,"Abo::Barre_outil_article_"+o,"N");var s=i._options.context.page.xiti.xtn2,a="CS1-263[BOUTONS_LMFR]-["+r+"]-"+s+"-[Article]";i._options.context.element.restreint&&(a="EREC-266-["+i._options.context.element.url_friendly.replace(/-/g,"_")+"]--["+r+"]"),window.open(e.subscription.websiteUrl+"/#xtor="+a,"_blank")})}},_getPageUrl:function(i,t){var n=e.www.location.hostname;"undefined"!=typeof this._options.sharing&&"undefined"!=typeof this._options.sharing.use_current_location&&this._options.sharing.use_current_location===!0&&(n=window.location.hostname);var o="http://"+n+this._options.context.page.link;return"string"==typeof i&&""!==i&&(o+="#xtor="+i),"boolean"==typeof t&&t===!1?o:encodeURI(o)},parse:function(e){e=e||"body",$(e).find(".toolbar").unspin().append(this.$el).show()},_addSpin:function(){$(".toolbar").spin({height:30,width:534,spRadius:5,spWidth:2,spLength:3,spLines:12})},init:function(e){this._options=e,this.render().done($.proxy(this.parse,this))}}});
/* -- end module lmd/module/element/toolbar -- */
/* -- start module lmd/ui/form/compteur-input -- */
define("lmd/ui/form/compteur-input",["jquery"],function($){"use strict";return{init:function(t,n){var a=t.attr("maxlength"),e=t.val().length,r=a-e;t.keyup(function(){e=$(this).val().length,a>0&&(r=a-e>0?a-e:0,$(this).val($(this).val().substring(0,a)));var t=r;t+=r>1?" caractères restants":" caractère restant",n.html(t)}).keyup()}}});
/* -- end module lmd/ui/form/compteur-input -- */
/* -- start module hgn/www/partials/element/toolbar.html.mu.js@abs -- */
define("hgn/www/partials/element/toolbar.html.mu.js@abs",function(){return function(c,p,i){var _=this;_.b(i=i||"");_.b("<div class=\"conteneur_barre_outils\">");_.b("\n" + i);_.b("   <div class=\"barre_outils\">");_.b("\n" + i);_.b("      <span class=\"bt_abo txt1\">");_.b("\n" + i);_.b("         ");if(_.s(_.f("aboLabel",c,p,1),c,p,0,145,159,"{{ }}")){_.rs(c,p,function(c,p,_){_.b(_.t(_.f("aboLabel",c,p,0)));});c.pop();}_.b("\n" + i);_.b("         ");if(!_.s(_.f("aboLabel",c,p,1),c,p,1,0,0,"")){_.b("Abonnez vous<span class=\"toolbar-label\"> à partir de 1 &euro;</span>");};_.b("\n" + i);_.b("      </span>");_.b("\n" + i);_.b("      <a class=\"reagir outil\" href=\"#liste_reactions\"><span class=\"ico\"></span><span class=\"toolbar-label\"> Réagir</span></a>");_.b("\n" + i);_.b("      <span class=\"classer outil\"><span class=\"ico\"></span><span class=\"toolbar-label\"> Ajouter</span></span>");_.b("\n" + i);_.b("      <span class=\"outil_imprimer outil\" title=\"Imprimer\"><span class=\"imprimer ico\"></span></span>");_.b("\n" + i);_.b("      <span class=\"outil_envoyer outil\" title=\"Envoyer\"><span class=\"envoyer ico\"></span></span>");_.b("\n" + i);_.b("      <p class=\"partage\">");_.b("\n" + i);_.b("         <span class=\"outil_partage_facebook facebook outil\" title=\"Partager sur Facebook\"><span class=\"facebook ico\"></span><span class=\"toolbar-label\">Partager </span>");if(_.s(_.f("facebook_likes",c,p,1),c,p,0,938,958,"{{ }}")){_.rs(c,p,function(c,p,_){_.b("(");_.b(_.v(_.f("facebook_likes",c,p,0)));_.b(")");});c.pop();}_.b("</span>");_.b("\n" + i);_.b("         <span class=\"outil_partage_twitter twitter outil\" title=\"Partager sur Twitter\"><span class=\"twitter ico\"></span><span class=\"toolbar-label\">Tweeter</span></span>");_.b("\n" + i);_.b("      </p>");_.b("\n" + i);_.b("   </div>");_.b("\n" + i);_.b("   <p class=\"confirmation\" style=\"display:none\"><span class=\"message\"></span><span class=\"fermer\">fermer </span></p>");_.b("\n" + i);if(_.s(_.f("loginPartial",c,p,1),c,p,0,1314,1343,"{{ }}")){_.rs(c,p,function(c,p,_){_.b("      ");_.b(_.t(_.f("loginPartial",c,p,0)));_.b("\n");});c.pop();}if(!_.s(_.f("loginPartial",c,p,1),c,p,1,0,0,"")){_.b("      <div class=\"teaser clearfix reaction_identifier\" style=\"display:none\">");_.b("\n" + i);_.b("         <div class=\"non_abo classer\" style=\"display:none\">");_.b("\n" + i);_.b("            <span class=\"txt6 bold-title\">Ajouter</span>");_.b("\n" + i);_.b("            <p class=\"tt4_capital txt_classer clearfix\"><span class=\"agauche\">Pas le temps de<br>lire cet article ?</span><span class=\"bg\"></span></p>");_.b("\n" + i);_.b("            <p class=\"texte\">Conservez-le pour le consulter plus tard. Abonnez-vous au Monde.fr <strong><br/>&agrave; partir de 1 &euro;</strong></p>");_.b("\n" + i);_.b("            <span class=\"btn_abo\">Abonnez-vous</span>");_.b("\n" + i);_.b("         </div>");_.b("\n" + i);_.b("         <div class=\"mini-login\">");_.b("\n" + i);_.b("            <div class=\"deja_abo txt3_120\">");_.b("\n" + i);_.b("               <div class=\"form\">");_.b("\n" + i);_.b("                  <span class=\"txt6 mgb16 clearfix bold-title\">Déjà abonné ?</span>");_.b("\n" + i);_.b("                  <p><a role=\"button\" id=\"btn_identification\" class=\"btn identifier js_trigger_login_register\" data-route=\"connexion\" href=\"https://");_.b(_.v(_.d("conf.wwwssf.location.hostname",c,p,0)));_.b("/sfuser/connexion\">S'identifier</a></p>");_.b("\n" + i);_.b("               </div>");_.b("\n" + i);_.b("            </div>");_.b("\n" + i);_.b("         </div>");_.b("\n" + i);_.b("      </div>");_.b("\n");};_.b("</div>");_.b("\n");return _.fl();;}})
/* -- end module hgn/www/partials/element/toolbar.html.mu.js@abs -- */
/* -- start module lmd/module/element/reaction -- */
define("lmd/module/element/reaction",function(require){"use strict";require("lib/jquery/plugin/jquery.prettydate"),require("lmd/core/context");var $=require("jquery"),i=require("lmd/core/auth"),t=require("lmd/core/conf"),e=require("lmd/module/xiti/hit"),o=require("lmd/ui/form/compteur-input"),n={_initDeferred:null,element_id:null,$root:null,$localForm:null,$globalForm:null,num_reaction:null,limit_reaction:3,signature:null,init:function(t,e){var o=this;return this.element_id=e,this.$root=$(t||"this"),$("[data-date-iso]",o.$root).prettyDate({interval:3e4}),null===this._initDeferred&&(this._initDeferred=$.Deferred(),i.loadUser().done(function(){i.authenticated&&i.user.abonne?($(".reaction_identifier",this.$root).remove(),o.signature=i.user.prenom+" "+i.user.nom,o._getUserInfo().done(function(){o._initForm(),o._initReagir(),o._initRepondre(),o._initDeferred.resolve()})):($(".reaction_redaction",this.$root).remove(),o._initForm(),o._initReagir(),o._initRepondre(),o._initAbonnezVous(),o._initDeferred.resolve())})),this._initDeferred.promise()},_getUserInfo:function(){var i=this,t=$.Deferred();return $.getJSON("/ws/1/reaction/information/",{item_id:this.element_id},"jsonp").done(function(t){t.error!==!0&&(i.num_reaction=t.nb_user)}).then(function(){t.resolve()}),t.promise()},_initForm:function(){return this.num_reaction>=this.limit_reaction?void this._hideReaction():(null===this.$globalForm&&$(".reaction_identifier, .reaction_redaction",this.$root).filter(":first").length>0&&(this.$globalForm=$(".reaction_identifier, .reaction_redaction",this.$root).filter(":first"),this.$localForm=this.$globalForm.clone(!0,!0),this._initFormLogin(),this._initFormReaction(),this.$localForm.find("[name=reponse]").val(1)),$(".formReaction").css("display","block"),$(".bt_repondre, .bt_repondre .btn",this.$root).css("visibility","auto"),void $(".bt_reagir").css("visibility","visible"))},_initFormLogin:function(){var t=this.$globalForm.add(this.$localForm);$(".deja_abo",t).on("submit",function(t){t.preventDefault(),t.stopPropagation();var e=$(this).serialize(),o=this;i.login(e,!0).done(function(t){return t.result?void i.loadUser().done(function(){document.location.reload()}):void $(".erreur",o).show()})}),$(".password_recover",t).on("click",function(i){i.preventDefault(),i.stopPropagation(),$(".trigger_boite_login").click(),$("#password_recover").click()}),t.filter(".reaction_identifier").each(function(){})},_hideReaction:function(){$(".reaction_identifier,.reaction_redaction",this.$root).remove(),$(".bt_repondre, .bt_repondre .btn",this.$root).css("visibility","hidden"),$(".bt_reagir",this.$root).css("visibility","hidden")},_initFormReaction:function(){var i=this,t=this.$globalForm.add(this.$localForm);$(".infobulle",this.$root).removeClass("infobulle"),t.filter(".reaction_redaction").each(function(){o.init($("textarea",this),$(".annotation",this));var t=this;i.afficherNbRestant(this,".num_reaction",i.num_reaction+1),$("[name=signature]").data("default",i.signature).val(i.signature),$(this).on("submit",function(i){i.preventDefault(),i.stopPropagation();var t=$(this).serialize();$.post("/ws/1/reaction/valider/",t,"json").done($.proxy(function(i){return i.error===!0&&i.message.length>0?void $(".erreur",this).html(i.message).show():($(".erreur",this).hide(),void $(".confirmation",this).show())},this))}),$(".modifier, .annuler",t).off("click"),$(".modifier, .annuler",t).on("click",function(){var i=$("[name=signature]",t);$(".modifier, .annuler, .alerte",t).toggle(),"undefined"!=typeof i.attr("readonly")?(i.removeAttr("readonly"),i.val("").focus()):(i.attr("readonly","readonly"),i.val(i.data("default")))}),$(".confirmation",this).off("click"),$(".confirmation",t).on("click",".fermer",function(){$(this).closest(".confirmation").hide()}),$(".regles_conduite",this).off("click"),$(".regles_conduite",this).on("click",function(){$("ul",this).slideToggle(),$(".fle_ferme,.fle_ouvert",this).toggleClass("fle_ouvert fle_ferme")})})},_initReagir:function(){var i=this;$(".bt_reagir",this.$root).on("click",function(t){t.preventDefault(),t.stopPropagation(),i.$localForm.detach(),$(window).scrollTop(i.$globalForm.offset().top-20)})},_initRepondre:function(){var i=this;$(".js_bt_repondre",this.$root).on("click",function(t){if(t.preventDefault(),t.stopPropagation(),null!==this.$localForm){var e=$(this).closest(".reaction");i.$localForm.insertAfter(e),i.$localForm.find("[name=element_id]").val(e.data("reaction_id")),i._initFormReaction()}})},_initAbonnezVous:function(){this.$root.find(".abo_link").on("click",function(i){i.preventDefault(),i.stopPropagation(),e.hit(i.currentTarget,"C","","Abo::Reagir","N");var o="CS1-263[BOUTONS_LMFR]-[REAGIR]-"+lmd.context.page.xiti.xtn2+"-[Article]";lmd.context.element.restreint&&(o="EREC-266-["+lmd.context.element.url_friendly.replace(/-/g,"_")+"]--[REAGIR]"),window.open(t.subscription.websiteUrl+"/#xtor="+o,"_blank")})},afficherNbRestant:function(i,t,e){var o,n="e";e>3&&(e=3),1===e&&(n="re"),o=e+"<sup>"+n+"</sup>",$(t,i).html(o)}};return n});
/* -- end module lmd/module/element/reaction -- */
/* -- start module lmd/ui/lecture-zen -- */
define("lmd/ui/lecture-zen",function(require){"use strict";var $=require("jquery"),t=require("lmd/ui/lightbox"),i=require("lmd/core/auth"),e=require("lmd/module/element/toolbar"),o=require("lmd/core/social/facebook"),n=(require("lib/object-path"),null),r={id:null,el:".btn_lecture_zen",wrapper:".article_normal div#articleBody",elReaction:"p.reaction a, a.reagir.outil",listeReaction:".liste_reactions",topPos:75,bottomPos:25},s={overlay:".fond_overlay.lecture_zen",wrapper:".overlay.lecture_zen",button:".fermer_lecture_zen",top:0,overlayClose:!1,overlaySpeedIn:250,overlaySpeedout:250},l="/ws/1/element/zen/",a=0,p=!1,c=function(){var c=function(){};return c.prototype={init:function(t){var i=this;if(r=$.extend(r,t),void 0===r.id||void 0===r.envoyer||void 0===r.imprimer)throw new Error("Lecture zen : Attention, tous les paramètres doivent être renseigné");if(null===r.id)throw new Error("Lecture zen : Un id d’item doit être passé en paramètre lors de l’initialisation");l+=r.id+"/",i.create()},open:function(i){var e=this;this.lightbox=new t(s),this.lightbox.setLoader(!0),this.isOpen=!0,$.getJSON(l,null,"jsonp").done(function(t){e.lightbox.on("open",function(){e.fixSiblingsPositions(!0),e.fixOverlayHeader(!0),e.loadToolbar(),e.triggerIgnitionOne(),$(document).scrollTop(0),"function"==typeof i&&i()}),e.lightbox.on("close",function(){e.close()}),a=$(window).scrollTop(),p=!1,e.lightbox.open(t.content),$(r.elReaction).on("click",function(t){t.preventDefault(),p=!0,e.lightbox.close()})}).fail(function(){e.lightbox.close(),e.isOpen=!1})},close:function(){this.fixSiblingsPositions(!1),this.fixOverlayHeader(!1),p?$(window).scrollTop($(r.listeReaction).offset().top):$(window).scrollTop(a),this.isOpen=!1},create:function(){var t=this;this.bouton=$("<div>").addClass(r.el.substr(1)).hide();var e;$.getJSON(l,null,"jsonp"),$(r.wrapper).append(this.bouton),this.bouton.fadeIn("fast"),this.isHide=!1,$(r.wrapper+" p").each(function(t){if(""!==$.trim($(this).html()))return e=t,!1}),null!=e&&(this.limitTop=$(r.wrapper+" p:eq("+e+")").offset().top),this.limitBottom=this.limitTop+$(r.wrapper).height(),this.isOpen=!1,this.adjust(),i.authenticated&&i.loadUser().done(function(){i.user.abonne===!0&&t.bouton.on("click",$.proxy(t.open,t))}),$(window).on("scroll",$.proxy(this.adjust,this))},adjust:function(){var t=$(r.el),i=$(window).scrollTop(),e=$(r.wrapper).parent().offset().left-55;this.isOpen||(i<=this.limitBottom-r.bottomPos?(this.isHide&&(t.fadeIn("fast"),this.isHide=!1),i<=this.limitTop-r.topPos?t.css({top:this.limitTop-i,left:e}):t.css({top:r.topPos,left:e})):(t.fadeOut("fast"),this.isHide=!0))},loadToolbar:function(){e._options.envoyer=r.envoyer,e._options.imprimer=r.imprimer,e.$el=$(s.wrapper),e._initSharing(),e._initEnvoyer(),e._initImprimer(),e._initClasser(),e._initReagir(),o.load().done(function(){o.parse({})}),void 0!==window.twttr&&twttr.widgets.load(),$("article #publisher",$(s.wrapper)).text($("article #publisher").data("source"))},triggerIgnitionOne:function(){require(["lmd/core/metrics/ignition-one"],function(t){t.triggerAction("zen")})},fixSiblingsPositions:function(t){var i=t||!1,e=$("header");i?e.css({position:"fixed",width:"100%"}):e.css({position:"relative"})},fixOverlayHeader:function(t){var i=t||!1,e=$(s.button);i?$("body").append(e):e.remove()}},{getInstance:function(){return null===n&&(n=new c),n},getConfig:function(){return r}}}();return c});
/* -- end module lmd/ui/lecture-zen -- */
/* -- start module lmd/module/portfolio -- */
define("lmd/module/portfolio",function(require){"use strict";function t(t){t.which!==p.KEYS.arrow_right&&t.which!==p.KEYS.arrow_left||this.state.started||(this.state.returnedToCover?this.setState({returnedToCover:!1}):t.which===p.KEYS.arrow_right&&this.start())}function e(){r("C","","Portfolio::demarrer","A"),this.start()}function s(t,e){return"mobile"!==c.application&&"mobileabo"!==c.application&&!this.isAtom&&("next"===e&&this.state.current===this.carousel.$slides.length-1||"previous"===e&&0===this.state.current)?this.loopToCover():(this.setState({current:this.carousel.slideIndex(this.$element.find(".slide.active"))}),void i(this))}function i(t){var e="",s=0;h.has(c,"page.xiti.xtpage")&&h.has(c,"page.xiti.xtn2")&&(s=t.carousel.slideIndex(t.$element.find(".slide.active"))+1,e=c.page.xiti.xtpage.replace(/(?=[^\:]*$).*/,"portfolio-"+s+"&x2=portfolio"),r("F",c.page.xiti.xtn2,e))}function a(t){r("C","","Portfolio::"+(this.state.current+1),"A"),r("C","","Portfolio::"+$(t.target).data("slide"),"A")}function o(){var t=require("hoganpower!/partials/element/portfolio/content-fullscreen.html.mu@www"),e=null,s=null,i=this.$element.data("lmd.portfolio.fullscreen")||{};i.state=this.state,r("C","","Portfolio::plein_ecran","A"),e=new p($(t.render(i)),this.carousel.options),e.$element.data("lmd.carousel",e),s=new v(e.$element,e),s.setState(this.state),s.sync(),s.state.started?s.$element.find(".js-toolbar .js-button.bt-infos").addClass("actif"):s.$element.find(".js-toolbar .js-button.bt-infos").removeClass("actif"),$("body").addClass("portfolio-plein-ecran").append(s.$element),s.$element.focus(),s.$element.on("click.lmd.fullscreen",".js-close",n.bind(null,s,this)),s.$element.on("keydown.lmd.fullscreen",function(t){t.which===v.KEYS.escape&&(n(s,this),t.preventDefault())}.bind(this)),s.$element.on("click.lmd.fullscreen",".js-toolbar .js-button",function(){$(".js-toolbar .js-button").removeClass("actif"),$(this).addClass("actif"),$("#panneau-lateral .js-panel").addClass("inactif"),$("#panneau-lateral").removeClass("inactif"),$(".js-hide").removeClass("actif"),$("#"+$(this).data("target")).removeClass("inactif")}).on("click.lmd.fullscreen",".js-toolbar .js-hide",function(){$(".js-toolbar .js-button").removeClass("actif"),$(this).addClass("actif"),$("#panneau-lateral").addClass("inactif")}),u.init(".contenu-portfolio-fullscreen"),this.setState({playing:!1})}function n(t,e){$("body").removeClass("portfolio-plein-ecran"),e.setState(t.state),e.sync(),e.carousel.$slides.eq(e.state.current).addClass("active"),e.carousel.to(e.state.current),e.$element.focus(),t.$element.remove(),e.state.started?e.hideCover():e.loopToCover()}function l(){this.state.started||this.start(),this.setState({playing:!this.state.playing}),this.$pauseplay.toggleClass("pause play"),this.carousel.cycle(!0),r("C","","Portfolio::"+(this.state.playing?"play":"pause"),"A")}function r(){"function"==typeof window.xt_med&&window.xt_med.apply(null,arguments)}function d(){var t=this.data("lmd.portfolio");t||(this.data("lmd.carousel.ready")?this.data("lmd.portfolio",t=new v(this,this.data("lmd.carousel"))):this.one("carousel.ready",function(e,s){this.data("lmd.portfolio",t=new v(this,s))}.bind(this)))}var $=require("jquery"),c=require("lmd/core/context"),h=require("lib/object-path"),u=require("lmd/ui/sharing"),f=require("lmd/util/swipe"),p=require("lmd/ui/carousel"),m=12e3,v=function(i,n){i.find(".js_start");this.$element=i,this.isAtom=void 0!==i.attr("data-is-atom"),this.isAtom===!1&&this.$element.focus(),this.$pauseplay=this.$element.find(".bt-lecture"),this.carousel=n,this.transitionEvents=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"].join(" "),this.setInitialState(),this.$element.addClass("disponible"),this.$element.find(".js_start").text("Démarrer la lecture"),this.isAtom||"mobile"===c.application||"mobileabo"===c.application?this.start():(this.$element.on("click.lmd.portfolio.start",".js_start",e.bind(this)),this.$element.on("click.lmd.portfolio.fullscreen",".bt-plein-ecran",o.bind(this))),this.$element.on("click.lmd.portfolio.slide",".js-arrows [data-slide]",a.bind(this)),this.$element.on("click.lmd.portfolio.playpause",".js_controls",l.bind(this)),this.$element.on("lmd.carousel.slid",s.bind(this)),this.$element.on("keyup.lmd.portfolio",t.bind(this)),this.$element.find("figure").each(function(t,e){f(e,function(t){t.x<0?n.previous():n.next()})})};v.KEYS={escape:27},v.prototype.hideCover=function(){this.$element.find(".infos-portfolio").addClass("invisible")},v.prototype.showCover=function(){this.$element.find(".infos-portfolio").show().removeClass("invisible"),this.$element.find(".compteur [data-carousel-item=currentIndex]").html(0)},v.prototype.loopToCover=function(){this.setInitialState(),this.$element.removeClass("js-started"),this.setState({current:0,returnedToCover:!0}),this.sync(),this.$element.find(".slide.active").removeClass("active"),this.carousel.$slides.eq(0).addClass("active"),this.carousel.sync(this.$element.find(".slide.active")),this.showCover()},v.prototype.setInitialState=function(t){return this.setState({playing:!1,started:!1,current:this.carousel.slideIndex(this.$element.find(".slide.active"))})},v.prototype.setState=function(t){var e;this.state=this.state||{};for(e in t)this.state[e]=t[e];this.carousel.sliding=!this.state.started,this.carousel.paused=!this.state.playing,this.carousel.options.interval=!!this.state.playing&&m},v.prototype.start=function(){var t=this.$element.find(".slide.active");this.state.started||this.$element.find(".infos-portfolio").addClass("invisible").one(this.transitionEvents,function(){$(this).hide()}),this.setState({started:!0}),this.$element.find(".compteur [data-carousel-item=currentIndex]").html(this.carousel.$slides.index(t)+1),this.$element.addClass("js-started"),$(".contenu-portfolio-fullscreen .js-toolbar .js-button.bt-infos").addClass("actif"),i(this),r("C","","Portfolio::"+(this.state.current+1),"A")},v.prototype.sync=function(){this.carousel.to(this.state.current),this.carousel.cycle(!0),this.state.started&&this.start(),this.state.playing?this.$pauseplay.removeClass("play").addClass("pause"):this.$pauseplay.removeClass("pause").addClass("play")},$(window).on("load",function(){$('[data-ui="carousel"][data-module="portfolio"]').each(function(){d.call($(this))})})});
/* -- end module lmd/module/portfolio -- */