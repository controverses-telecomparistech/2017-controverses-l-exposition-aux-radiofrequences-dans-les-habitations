function _OnReady(){var n=this,i,t;(Video._ready=!0,n.config.type!="flv")&&(initPrevNextPlayer(_isWebTv),_isWebTv||($(".jwelapsed").text(Video._localTimeStart.toTimeString(":")),$(".jwduration").text(Video._localTimeStop.toTimeString(":")),$("#myPlayer_controlbar").data("time",{elapsed:$(".jwelapsed").text(),duration:$(".jwduration").text()})),$(".blackBg").length>0&&$(".blackBg").remove(),n.config.type!="mp3"?($(window).width()>=600&&($("#myPlayer_controlbar .jwgroup.jwcenter").css({right:"115px"}),$(".PlayerPlugin").height(280)),$(window).width()<640&&$(".mainPanel").length>0&&($("#divPlayerContainer").height(160),$("#divPlayerPlugin").removeAttr("style")),$(".ContainPlayer").removeAttr("style"),$("#fakeControlBar").show(),n.getRenderingMode()=="flash"&&$("#fakeControlBar").remove()):(i=n.getRenderingMode()=="flash",t=$(".mainPanel").length>0,$(".ContainPlayer").removeAttr("style"),t?($("#divPlayerContainer, #divPlayerPlugin").removeAttr("style"),$(window).width()<=640?$("#myPlayer_controlbar").css("top","0"):($("#fakeControlBar").css("top","0"),$("#myPlayer_controlbar .jwgroup.jwcenter").css({right:"86px"}))):$("#myPlayer_controlbar .jwgroup.jwcenter").css({right:"86px"}),$(".ContainPlayer").css("background-color","#3D3D3F"),$("#fakeControlBar").show(),i&&!t?($(window).width()>=600&&($(".PlayerPlugin").height(70),$(".jwfullscreen").remove()),$("#myPlayer_wrapper").height(69).css("top","1px"),$("#fakeControlBar").hide()):($(window).width()>=600&&$(".PlayerPlugin").height(41),$(".jwfullscreen").remove())))}function _OnPlay(){var n=this,t;_teasing&&(n.setVolume(Video._volumeTeasing),n.config.type!="mp3"&&(n.setControls(!1),$("#myPlayer_controlbar").attr("style","display: none !important;"),$("#fakeControlBar").hide()));t=n.config.type=="mp3"?"ConsumeRadio":"ConsumeVideo";_consumeMedia||$.ajax({url:"/Media/"+t,async:!1,dataType:"html",data:{docName:_docName,docNameMedia:_docNameVideo},success:function(t,i,r){var u=r.getResponseHeader("ERROR_MESSAGE");if(u!=null){$("#divPlayerPlugin").html("");alert(u);return}t!=""&&(_limitReached=t);_consumeMedia=!0;n.config.type!="mp3"&&$(window).width()>600&&$("#myPlayer_controlbar .jwgroup.jwcenter").addClass("player-rail-fix");$("#playPlayer").children().addClass("fa-pause").removeClass("fa-play");Video._ready&&!_teasing&&_limitReached==""&&Video._localTimeFirstHit.getSeconds()>0&&n.seek(Video._localTimeFirstHit.getSeconds())}}).fail(function(n,t,i){$("#divPlayerPlugin").html(Video._fileNotFound);$("#fakeControlBar").hide();$(".mainPanel").length>0&&$(".mainPanel").css({top:"470px"});alert(i)})}function _OnFullScreen(){var n=this.getFullscreen();n?($("#myPlayer_controlbar").addClass("controlbar-fullscreen"),$(".jwrail").addClass("jwrail-fullscreen"),$(".jwplay").show(),$(".jwgroup.jwright").addClass("jwright-fullscreen"),$(".jwcapRight").addClass("jwcapRight-fullscreen"),$(".jwright .jwfullscreen button").attr({title:lbl_QuitFullScreen})):($("#myPlayer_controlbar").removeClass("controlbar-fullscreen"),$(".jwrail").removeClass("jwrail-fullscreen"),$(".jwplay").hide(),$(".jwgroup.jwright").removeClass("jwright-fullscreen"),$(".jwcapRight").removeClass("jwcapRight-fullscreen"),$(".jwright .jwfullscreen button").attr({title:lbl_FullScreen}))}function _OnError(){var n=this;Video._ready=!1;$("#divPlayerPlugin").html(Video._fileNotFound);$(".mainPanel").length>0&&$(window).width()<=640&&n.config.type!="mp3"&&$(".errorContainer").height(135);$("#fakeControlBar").hide()}function _OnTime(n){if(_isWebTv||(Video._localTimeStart.setSeconds(n.position),$(".jwelapsed").text(Video._localTimeStart.toTimeString(":")),$(".jwduration").text(Video._localTimeStop.toTimeString(":"))),n.position>=Video._fadoutStart&&(_teasing||_limitReached!="")){if(this.setVolume((Video._fadoutStart+Video._fadoutDuration-n.position)*Video._volumeTeasing/Video._fadoutDuration),this.config.type=="mp3"&&n.position>=Video._fadoutStart+Video._fadoutDuration){_ShowTeasing(this);$(".mainPanel").length>0&&$("#divPlayerContainer").css({height:280}).fadeIn();return}if(this.config.type=="mp3"||_teasingReached)return;_teasingReached=!0;var t=this;$("#divPlayerPlugin").fadeOut(Video._fadoutDuration*1e3,function(){$("#divPlayerPlugin").css({visibility:"hidden"}).show();$(".mainPanel").length>0&&$(window).width()<768&&$("#divPlayerContainer").css({height:280});_ShowTeasing(t)})}}function _ShowTeasing(n){n.stop();n.config.type=="mp3"&&($(".mainPanel").length>0?$(".ContainPlayer").height(280):$(".ContainPlayer").animate({height:"280px"},1e3));$("#fakeControlBar").hide();_limitReached!=""?$("#divPlayerPlugin").css({visibility:"visible",height:280}).hide().html(_limitReached).fadeIn(Video._fadinDuration*1e3):$.ajax({url:"/Teasing/Media",dataType:"html",success:function(n){$("#divPlayerPlugin").css({visibility:"visible",height:280}).hide().html(n).fadeIn(Video._fadinDuration*1e3)}})}function _OnBeforeComplete(){var n=this;$.ajax({url:"/Media/NextVideoSegment",async:!1,dataType:"html",success:function(t){if(n.config.type=="mp3"){$("#divPlayerPlugin").prepend(t).removeAttr("style");$(".nextVideoConsole").css("background-color","#000");$(".ContainPlayer").prepend('<div class="blackBg"><\/div>').css({height:"auto"});$("#myPlayer").height(40);$("#playPlayer").prop("disabled","disabled").addClass("prevNext-disabled");$(".mainPanel").length>0&&($("#fakeControlBar").removeClass(),$(window).width()<=640&&$("#divPlayerContainer").height(120));disabledlastminute();n.getRenderingMode()=="flash"&&($("#myPlayer").hide(),$(".PlayerPlugin").height(35));return}n.getRenderingMode()!="flash"?($("#divPlayerPlugin").prepend(t),$(".nextVideoConsole").addClass("console-height"),$("#myPlayer").css({height:"40px"}),$("#myPlayer_display_button").remove(),$("#myPlayer_display").remove(),$("#myPlayer_controlbar").css({display:"inline-block",opacity:"1"}),$("#playPlayer").prop("disabled","disabled").addClass("prevNext-disabled"),disabledlastminute()):($("#divPlayerPlugin").prepend(t),$(".nextVideoConsole").addClass("console-height"),$("#myPlayer").hide(),disabledlastminute());$(".mainPanel").length>0&&$(window).width()<=640&&$(".nextVideo").addClass("nextVideo-position")}})}function _onComplete(){$(".nextVideoConsole").length>0&&($("#myPlayer_controlbar_elapsed").text($("#myPlayer_controlbar").data("time").elapsed),$("#myPlayer_controlbar_duration").text($("#myPlayer_controlbar").data("time").duration))}function setDocHtml(n){var i=$(".PlayOn").length>0?$(".PlayOn").parent().index():0,t=$.ajax({url:"/Document/DocHtml",method:"POST",data:{viewEvent:_viewEvent,docRefId:_docRefId,docName:_docName,docIndex:_docIndex,kwicMode:getTvRadioKwikMode()},dataType:"html"});t.done(function(t){var u=$(t).find(".DocText").html(),r;$(".DocText").html(u);r=$(".transcript").eq(i);r.children().first().removeClass("PlayOff").addClass("PlayOn");n&&$(".PlayOn").click();$(".transcripts").scrollTo(r);stubs()});t.fail(function(n){var t=n.getResponseHeader("LOGIN_REQUIRED");t!=null?window.location=t:alert(n.responseText)})}function showConsole(){if(_hasMedia||$("#divPlayerContainer").css({display:"none"}),$(".transcript").not(".emptyTranscript").length>0){$(".transcript").not(".emptyTranscript").children().first().click();return}$(".MinuteOpenAll").text(lbl_OccText);$(".MinuteOpenAll").attr("class","MinuteOpenPartial");setDocHtml(!0)}function displayKwicMode(){$(document).on("click",".MinuteOpenAll",function(){$(this).text(lbl_OccText);$(this).attr("class","MinuteOpenPartial");logUsage("/Media/LogFullTextClick");setDocHtml(!1)});$(document).on("click",".MinuteOpenPartial",function(){$(this).text(lbl_FullText);$(this).attr("class","MinuteOpenAll");setDocHtml(!1)})}function transcriptTimeClicked(n){$(".nextVideoConsole").remove();$("#fakeControlBar").hide();$(".time").removeClass("PlayOn");$(".time").addClass("PlayOff");$(n).removeClass("PlayOff");$(n).addClass("PlayOn")}function startPlayMP3(n,t){var r=$(n).attr("file"),u=$(n).attr("docnameaudio"),i=$(n).attr("localtimestart");t||(i=$(n).text());typeof playMP3!="undefined"&&playMP3(r,_docName,u,i,_teasing)}function startPlayTvFrance(n,t){var i=Math.abs($(n).attr("offset")),r=$(n).attr("localtimestart");t||(r=$(n).text());typeof playTvFrance!="undefined"&&playTvFrance(_docName,_docnamevideo+"_"+i,_channel,_file,i,r,_teasing)}function startPlayTvCanada(n,t){var r=$(n).attr("docnamevideo"),u=Math.abs($(n).attr("offset")),i=$(n).attr("localtimestart");t||(i=$(n).text());typeof playTvCanada!="undefined"&&playTvCanada(_docName,r,_channel,_file,u,i,_teasing)}function startPlayEloda(n,t){var r=$(n).attr("docnamevideo"),u=$(n).attr("date"),f=$(n).attr("hour"),i=$(n).attr("localtimestart");t||(i=$(n).text());typeof playEloda!="undefined"&&playEloda(_docName,r,_channel,u,f,i,_teasing)}function simulateLinkPlayVideoClick(n,t){transcriptTimeClicked(n);$(n).hasClass("PlayMP3")?startPlayMP3(n,t):$(n).hasClass("PlayTvFrance")?startPlayTvFrance(n,t):$(n).hasClass("PlayTvCanada")?startPlayTvCanada(n,t):$(n).hasClass("PlayEloda")&&startPlayEloda(n,t)}function onLinkPlayVideoClick(){$(document).on("click",".time",function(){transcriptTimeClicked(this)});$(document).on("click",".PlayMP3",function(){startPlayMP3(this,!1)});$(document).on("click",".PlayTvFrance",function(){startPlayTvFrance(this,!1)});$(document).on("click",".PlayTvCanada",function(){startPlayTvCanada(this,!1)});$(document).on("click",".PlayEloda",function(){startPlayEloda(this,!1)})}function onPlayerClick(){$(document).on("click",".PlayerRadio, .PlayerVideo",function(){$(".transcript").not(".emptyTranscript").children().first().click()})}function prevNextClick(){$(document).on("click","#nextBtn",function(){$(this).hasClass("prevNext-disabled")||($(".nextVideoConsole").remove(),simulateLinkPlayVideoClick($(".PlayOn").closest(".transcript").next().find(".time"),!0))});$(document).on("click","#replayBtn",function(){$(".nextVideoConsole").remove();simulateLinkPlayVideoClick($(".PlayOn"),!0)});$(document).on("click","#prevPlayer",function(){closeActiveTooltip();var n=$(".PlayOn").closest(".transcript").prev();$(".transcripts").scrollTo(n);simulateLinkPlayVideoClick(n.find(".time"),!0)});$(document).on("click","#nextPlayer",function(){closeActiveTooltip();var n=$(".PlayOn").closest(".transcript").next();$(".transcripts").scrollTo(n);simulateLinkPlayVideoClick(n.find(".time"),!0)});$(document).on("click","#myPlayer_display_button",function(){switchPlayPause()})}function switchPlayPause(){if(typeof activePlayer!="undefined"){var n=activePlayer.getState();n=="IDLE"||n=="PAUSED"?$("#playPlayer").children().addClass("fa-pause").removeClass("fa-play"):n=="PLAYING"&&$("#playPlayer").children().addClass("fa-play").removeClass("fa-pause")}}function closeActiveTooltip(){$(".ui-tooltip").length>0&&$("[title]").tooltip("close")}function setConsoleCtrls(n){$(".ctrl-bar-controls").length>0&&$(".ctrl-bar-controls").remove();$("#fakeControlBar").append("<div class='ctrl-bar-controls'><\/div>");n?$(".ctrl-bar-controls").append('<button id="playPlayer" title="'+lbl_PlayPause+'"><i class="fa fa-play"><\/i><\/button>'):($(".ctrl-bar-controls").append('<button id="prevPlayer" title="'+lbl_PrevMin+'"><i class="fa fa-step-backward"><\/button>'),$(".ctrl-bar-controls").append('<button id="playPlayer" title="'+lbl_PlayPause+'"><i class="fa fa-play"><\/i><\/button>'),$(".ctrl-bar-controls").append('<button id="nextPlayer" title="'+lbl_NextMin+'"><i class="fa fa-step-forward"><\/button>'),$(".jwprev, .jwnext").hide(),$(".PlayOn").closest(".transcript").is(":first-child")&&$("#prevPlayer").addClass("prevNext-disabled"),$(".PlayOn").closest(".transcript").is(":last-child")&&$("#nextPlayer").addClass("prevNext-disabled"),$("#myPlayer_controlbar_timetooltip").addClass("hide_tooltip"),$("#myPlayer_controlbar_timetooltip").css("transition","none"));$(".jwplay").hide();$(".jwfullscreen button").attr({title:lbl_FullScreen})}function initPrevNextPlayer(n){activePlayer=jwplayer("myPlayer");$(".jwplayer").on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(n){n.stopPropagation()});setConsoleCtrls(n);$(".jwrail").on("mousemove",function(){var n=$(".jwoverlaytext").text(),t=n.indexOf("("),i=n.lastIndexOf(")"),r;t>=0&&i>0?(r=n.substring(0,t).trim(),t+1<i&&(r+="<br/>"+n.substring(t+1,i)),$(".jwoverlaytext").html(r),$("#myPlayer_controlbar_timetooltip").removeClass("hide_tooltip")):$("#myPlayer_controlbar_timetooltip").addClass("hide_tooltip")})}function disabledlastminute(){$(".PlayOn").closest(".transcript").is(":last-child")&&$("#nextBtn").addClass("prevNext-disabled")}function initConsole(){Video.InitPlayer();onLinkPlayVideoClick();onPlayerClick();prevNextClick()}var _teasing,_consumeMedia,_limitReached,_teasingReached,_docName,_docNameVideo,_isWebTv=!1,Video,activePlayer;Date.prototype.toTimeString=function(n){var t=this.getHours().toString(),i=this.getMinutes().toString(),r=this.getSeconds().toString();return(t[1]?t:"0"+t[0])+n+(i[1]?i:"0"+i[0])+n+(r[1]?r:"0"+r[0])};Video={_JWPlayerKey:"EeIr/5S8jBIk+V2IWOld3sncmz0Ykcxraryh4g==",_ready:!1,_fileNotFound:null,_fadoutStart:3,_fadoutDuration:5,_fadinDuration:2,_volumeTeasing:80,_localTimeStart:null,_localTimeStop:null,_localTimeFirstHit:null,_duration:60,SetTime:function(n){Video._localTimeStart=new Date;Video._localTimeStart.setHours(n.substr(0,2),n.substr(3,2),0);Video._localTimeStop=new Date;Video._localTimeStop.setHours(n.substr(0,2),n.substr(3,2),Video._duration);Video._localTimeFirstHit=new Date;Video._localTimeFirstHit.setHours(n.substr(0,2),n.substr(3,2),n.substr(6,2))},PlayFile:function(n,t,i,r){var f=n.split(".").pop(),e="/FileStreaming.axd?file="+encodeURIComponent(n),u;_consumeMedia=!1;_teasing=!1;_docName=t;_docNameVideo=i;_isWebTv=!0;u=typeof r!="undefined"?r:280;$(".ContainPlayer").css("height",u+"px");jwplayer.key=Video._JWPlayerKey;jwplayer("myPlayer").setup({primary:"html5",flashplayer:"/js/player/jwplayer.flash.swf",file:e,type:f,height:u,width:"100%",analytics:{enabled:!1},autostart:Video._ready,events:{onReady:_OnReady,onFullscreen:_OnFullScreen,onPlay:_OnPlay,onError:_OnError}})},PlayEloda:function(n,t,i,r,u,f,e){var o=VideoConfig.videoFeederConsole+"mp4/ca/"+i+"/"+r+"/"+u+"/"+(f?Video._fadoutStart+Video._fadoutDuration:Video._duration)+"/true/true/video.mp4",s;_teasing=f;_consumeMedia=f;_limitReached="";_teasingReached=!1;_docName=n;_docNameVideo=t;s=typeof e!="undefined"?e:280;$(".ContainPlayer").height(e);jwplayer.key=Video._JWPlayerKey;jwplayer("myPlayer").setup({primary:"html5",flashplayer:"/js/player/jwplayer.flash.swf",file:o,height:e,width:"100%",analytics:{enabled:!1},autostart:Video._ready,tracks:[{file:"/Document/JWPlayerDocHits?key="+Video._localTimeStart.toTimeString(""),kind:"chapters"}],events:{onReady:_OnReady,onPlay:_OnPlay,onTime:_OnTime,onFullscreen:_OnFullScreen,onBeforeComplete:_OnBeforeComplete,onError:_OnError,onComplete:_onComplete}})},PlayTV:function(n,t,i,r,u,f,e,o){_teasing=e;_consumeMedia=e;_limitReached="";_teasingReached=!1;_docName=t;_docNameVideo=i;var s=typeof o!="undefined"?o:280;$(".ContainPlayer").css("height",o+"px");$.ajax({url:n,data:{channel:r,file:u,start:f,end:f+Video._duration},success:function(n){jwplayer.key=Video._JWPlayerKey;jwplayer("myPlayer").setup({primary:"html5",flashplayer:"/js/player/jwplayer.flash.swf",type:"mp4",file:n,height:o,width:"100%",analytics:{enabled:!1},autostart:Video._ready,tracks:[{file:"/Document/JWPlayerDocHits?key="+Video._localTimeStart.toTimeString(""),kind:"chapters"}],events:{onReady:_OnReady,onPlay:_OnPlay,onTime:_OnTime,onFullscreen:_OnFullScreen,onBeforeComplete:_OnBeforeComplete,onError:_OnError,onComplete:_onComplete}})}})},PlayMP3:function(n,t,i,r){var f="/FileStreaming.axd?file="+encodeURIComponent(n),u;_consumeMedia=r;_limitReached="";_teasing=r;_docName=t;_docNameVideo=i;_teasingReached=!1;u=41;$(".mainPanel").length>0&&$(window).width()<=1024&&($(".ContainPlayer").height(40),u=40);jwplayer.key=Video._JWPlayerKey;jwplayer("myPlayer").setup({primary:"html5",flashplayer:"/js/player/jwplayer.flash.swf",type:"mp3",file:f,height:u,width:"100%",analytics:{enabled:!1},autostart:Video._ready,tracks:[{file:"/Document/JWPlayerDocHits?key="+Video._localTimeStart.toTimeString(""),kind:"chapters"}],events:{onReady:_OnReady,onFullscreen:_OnFullScreen,onPlay:_OnPlay,onTime:_OnTime,onBeforeComplete:_OnBeforeComplete,onError:_OnError,onComplete:_onComplete}})},InitPlayer:function(){Video._fileNotFound='<div id="myPlayer" class="errorContainer"><img src="/images/interface/video/msg_fileNotFound_'+(VideoConfig.languageId==1?"fr":"en")+'.png"><\/div>'},ClosePlayer:function(){Video._ready&&(jwplayer("myPlayer").stop(),jwplayer("myPlayer").remove(),Video._ready=!1)},GetMp3Page:function(){return"/FileStreaming.axd?file="},GetMp3Uri:function(n,t){var i=Video.GetMp3Page();switch(t){default:case 0:i=i+n;break;case 1:i=i+encodeURIComponent(n);break;case 2:i=i+escape(n)}return i}};$(document).ready(function(){$("body").ajaxSuccess(function(n,t){var i=t.getResponseHeader("LOGIN_REQUIRED");i!=null&&($(this).parents("iframe").length>0?window.parent.location.href=i:window.location.href=i)})});jQuery.fn.scrollTo=function(n,t){return $(this).animate({scrollTop:$(this).scrollTop()-$(this).offset().top+$(n).offset().top},t==undefined?1e3:t),this};$(document).ready(function(){displayKwicMode();$(document).on("click","#playPlayer",function(){typeof activePlayer!="undefined"&&(switchPlayPause(),activePlayer.play())})})