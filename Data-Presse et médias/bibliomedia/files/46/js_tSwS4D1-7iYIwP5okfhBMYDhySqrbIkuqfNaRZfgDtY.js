!function($){var SmartBanner=function(options){this.origHtmlMargin=parseFloat($('html').css('margin-top'))
this.options=$.extend({},$.smartbanner.defaults,options)
var standalone=navigator.standalone,UA=navigator.userAgent
if(this.options.force){this.type=this.options.force}else if(UA.match(/Windows Phone 8/i)!=null&&UA.match(/Touch/i)!==null){this.type='windows'}else if(UA.match(/iPhone|iPod/i)!=null||(UA.match(/iPad/)&&this.options.iOSUniversalApp)){if(UA.match(/Safari/i)!=null&&(UA.match(/CriOS/i)!=null||window.Number(UA.substr(UA.indexOf('OS ')+ 3,3).replace('_','.'))<6))this.type='ios'}else if(UA.match(/\bSilk\/(.*\bMobile Safari\b)?/)||UA.match(/\bKF\w/)||UA.match('Kindle Fire')){this.type='kindle'}else if(UA.match(/Android/i)!=null){this.type='android'}
if(!this.type||standalone||this.getCookie('sb-closed')||this.getCookie('sb-installed')){return}
this.scale=this.options.scale=='auto'?$(window).width()/ window.screen.width : this.options.scale
if(this.scale<1)this.scale=1
var meta=$(this.type=='android'?'meta[name="google-play-app"]':this.type=='ios'?'meta[name="apple-itunes-app"]':this.type=='kindle'?'meta[name="kindle-fire-app"]':'meta[name="msApplication-ID"]');if(meta.length==0)return
if(this.type=='windows'){this.appId=$('meta[name="msApplication-PackageFamilyName"]').attr('content');}else{var parsedMetaContent=/app-id=([^\s,]+)/.exec(meta.attr('content'));if(parsedMetaContent){this.appId=parsedMetaContent[1];}else{return;}}
this.title=this.options.title?this.options.title:meta.data('title')||$('title').text().replace(/\s*[|\-Â·].*$/,'')
this.author=this.options.author?this.options.author:meta.data('author')||($('meta[name="author"]').length?$('meta[name="author"]').attr('content'):window.location.hostname)
this.iconUrl=meta.data('icon-url');this.price=meta.data('price');this.create()
this.show()
this.listen()}
SmartBanner.prototype={constructor:SmartBanner,create:function(){var iconURL,link=(this.options.url?this.options.url:(this.type=='windows'?'ms-windows-store:navigate?appid=':(this.type=='android'?'market://details?id=':(this.type=='kindle'?'amzn://apps/android?asin=':'https://itunes.apple.com/'+ this.options.appStoreLanguage+'/app/id')))+ this.appId),price=this.price||this.options.price,inStore=price?price+' - '+(this.type=='android'?this.options.inGooglePlay:this.type=='kindle'?this.options.inAmazonAppStore:this.type=='ios'?this.options.inAppStore:this.options.inWindowsStore):'',gloss=this.options.iconGloss===null?(this.type=='ios'):this.options.iconGloss
if(this.type=='android'&&this.options.GooglePlayParams){link=link+'&referrer='+ this.options.GooglePlayParams;}
var banner='<div id="smartbanner" class="'+this.type+'"><div class="sb-container"><a href="#" class="sb-close">&times;</a><span class="sb-icon"></span><div class="sb-info"><strong>'+this.title+'</strong><span>'+this.author+'</span><span>'+inStore+'</span></div><a href="'+link+'" class="sb-button"><span>'+this.options.button+'</span></a></div></div>';(this.options.layer)?$(this.options.appendToSelector).append(banner):$(this.options.appendToSelector).prepend(banner);if(this.options.icon){iconURL=this.options.icon}else if(this.iconUrl){iconURL=this.iconUrl;}else if($('link[rel="apple-touch-icon-precomposed"]').length>0){iconURL=$('link[rel="apple-touch-icon-precomposed"]').attr('href')
if(this.options.iconGloss===null)gloss=false}else if($('link[rel="apple-touch-icon"]').length>0){iconURL=$('link[rel="apple-touch-icon"]').attr('href')}else if($('meta[name="msApplication-TileImage"]').length>0){iconURL=$('meta[name="msApplication-TileImage"]').attr('content')}else if($('meta[name="msapplication-TileImage"]').length>0){iconURL=$('meta[name="msapplication-TileImage"]').attr('content')}
if(iconURL){$('#smartbanner .sb-icon').css('background-image','url('+iconURL+')')
if(gloss)$('#smartbanner .sb-icon').addClass('gloss')}else{$('#smartbanner').addClass('no-icon')}
this.bannerHeight=$('#smartbanner').outerHeight()+ 2
if(this.scale>1){$('#smartbanner').css('top',parseFloat($('#smartbanner').css('top'))*this.scale).css('height',parseFloat($('#smartbanner').css('height'))*this.scale).hide()
$('#smartbanner .sb-container').css('-webkit-transform','scale('+this.scale+')').css('-msie-transform','scale('+this.scale+')').css('-moz-transform','scale('+this.scale+')').css('width',$(window).width()/ this.scale)
}
$('#smartbanner').css('position',(this.options.layer)?'absolute':'static')},listen:function(){$('#smartbanner .sb-close').on('click',$.proxy(this.close,this))
$('#smartbanner .sb-button').on('click',$.proxy(this.install,this))},show:function(callback){var banner=$('#smartbanner');banner.stop();if(this.options.layer){banner.animate({top:0,display:'block'},this.options.speedIn).addClass('shown').show();$(this.pushSelector).animate({paddingTop:this.origHtmlMargin+(this.bannerHeight*this.scale)},this.options.speedIn,'swing',callback);}else{if($.support.transition){banner.animate({top:0},this.options.speedIn).addClass('shown');var transitionCallback=function(){$('html').removeClass('sb-animation');if(callback){callback();}};$(this.pushSelector).addClass('sb-animation').one($.support.transition.end,transitionCallback).emulateTransitionEnd(this.options.speedIn).css('margin-top',this.origHtmlMargin+(this.bannerHeight*this.scale));}else{banner.slideDown(this.options.speedIn).addClass('shown');}}},hide:function(callback){var banner=$('#smartbanner');banner.stop();if(this.options.layer){banner.animate({top:-1*this.bannerHeight*this.scale,display:'block'},this.options.speedIn).removeClass('shown');$(this.pushSelector).animate({paddingTop:this.origHtmlMargin},this.options.speedIn,'swing',callback);}else{if($.support.transition){if(this.type!=='android')
banner.css('top',-1*this.bannerHeight*this.scale).removeClass('shown');else
banner.css({display:'none'}).removeClass('shown');var transitionCallback=function(){$('html').removeClass('sb-animation');if(callback){callback();}};$(this.pushSelector).addClass('sb-animation').one($.support.transition.end,transitionCallback).emulateTransitionEnd(this.options.speedOut).css('margin-top',this.origHtmlMargin);}else{banner.slideUp(this.options.speedOut).removeClass('shown');}}},close:function(e){$('#smartbanner').hide();this.setCookie('sb-closed','true',this.options.daysHidden);},install:function(e){if(this.options.hideOnInstall){this.hide()}
this.setCookie('sb-installed','true',this.options.daysReminder)},setCookie:function(name,value,exdays){var exdate=new Date()
exdate.setDate(exdate.getDate()+exdays)
value=encodeURI(value)+((exdays==null)?'':'; expires='+exdate.toUTCString())
document.cookie=name+'='+value+'; path=/;'},getCookie:function(name){var i,x,y,ARRcookies=document.cookie.split(";")
for(i=0;i<ARRcookies.length;i++){x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="))
y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1)
x=x.replace(/^\s+|\s+$/g,"")
if(x==name){return decodeURI(y)}}
return null},switchType:function(){var that=this
this.hide(function(){that.type=that.type=='android'?'ios':'android'
var meta=$(that.type=='android'?'meta[name="google-play-app"]':'meta[name="apple-itunes-app"]').attr('content')
that.appId=/app-id=([^\s,]+)/.exec(meta)[1]
$('#smartbanner').detach()
that.create()
that.show()})}}
$.smartbanner=function(option){var $window=$(window),data=$window.data('smartbanner'),options=typeof option=='object'&&option
if(!data)$window.data('smartbanner',(data=new SmartBanner(options)))
if(typeof option=='string')data[option]()}
$.smartbanner.defaults={title:null,author:null,price:'FREE',appStoreLanguage:'us',inAppStore:'On the App Store',inGooglePlay:'In Google Play',inAmazonAppStore:'In the Amazon Appstore',inWindowsStore:'In the Windows Store',GooglePlayParams:null,icon:null,iconGloss:null,button:'VIEW',url:null,scale:'auto',speedIn:300,speedOut:400,daysHidden:15,daysReminder:90,force:null,hideOnInstall:true,layer:false,iOSUniversalApp:true,appendToSelector:'body',pushSelector:'html'}
$.smartbanner.Constructor=SmartBanner;function transitionEnd(){var el=document.createElement('smartbanner')
var transEndEventNames={WebkitTransition:'webkitTransitionEnd',MozTransition:'transitionend',OTransition:'oTransitionEnd otransitionend',transition:'transitionend'}
for(var name in transEndEventNames){if(el.style[name]!==undefined){return{end:transEndEventNames[name]}}}
return false}
if($.support.transition!==undefined)
return
$.fn.emulateTransitionEnd=function(duration){var called=false,$el=this
$(this).one($.support.transition.end,function(){called=true})
var callback=function(){if(!called)$($el).trigger($.support.transition.end)}
setTimeout(callback,duration)
return this}
$(function(){$.support.transition=transitionEnd()})}(window.jQuery);;(function(){var supports=(function(){var supports={};var html;var work=this.document.createElement('div');html='<P><I></P></I>';work.innerHTML=html;supports.tagSoup=work.innerHTML!==html;work.innerHTML='<P><i><P></P></i></P>';supports.selfClose=work.childNodes.length===2;return supports;})();var startTag=/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/;var endTag=/^<\/([\-A-Za-z0-9_]+)[^>]*>/;var attr=/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g;var fillAttr=/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i;var DEBUG=false;function htmlParser(stream,options){stream=stream||'';options=options||{};for(var key in supports){if(supports.hasOwnProperty(key)){if(options.autoFix){options['fix_'+key]=true;}
options.fix=options.fix||options['fix_'+key];}}
var stack=[];var el=document.createElement('div');var unescapeHTMLEntities=function(html){if((typeof html==='string')&&(html.indexOf('&')!==-1)){el.innerHTML=html;return el.textContent||el.innerText||html;}
else{return html;}};var append=function(str){stream+=str;};var prepend=function(str){stream=str+ stream;};var detect={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/};var reader={comment:function(){var index=stream.indexOf('-->');if(index>=0){return{content:stream.substr(4,index-1),length:index+ 3};}},endTag:function(){var match=stream.match(endTag);if(match){return{tagName:match[1],length:match[0].length};}},atomicTag:function(){var start=reader.startTag();if(start){var rest=stream.slice(start.length);if(rest.match(new RegExp('<\/\\s*'+ start.tagName+'\\s*>','i'))){var match=rest.match(new RegExp('([\\s\\S]*?)<\/\\s*'+ start.tagName+'\\s*>','i'));if(match){return{tagName:start.tagName,attrs:start.attrs,content:match[1],length:match[0].length+ start.length};}}}},startTag:function(){var endTagIndex=stream.indexOf('>');if(endTagIndex===-1){return null;}
var match=stream.match(startTag);if(match){var attrs={};var booleanAttrs={};var rest=match[2];match[2].replace(attr,function(match,name){if(!(arguments[2]||arguments[3]||arguments[4]||arguments[5])){attrs[name]=null;}else if(arguments[5]){attrs[arguments[5]]='';booleanAttrs[name]=true;}else{var value=arguments[2]||arguments[3]||arguments[4]||fillAttr.test(name)&&name||'';attrs[name]=unescapeHTMLEntities(value);}
rest=rest.replace(match,'');});return{tagName:match[1],attrs:attrs,booleanAttrs:booleanAttrs,rest:rest,unary:!!match[3],length:match[0].length};}},chars:function(){var index=stream.indexOf('<');return{length:index>=0?index:stream.length};}};var readToken=function(){for(var type in detect){if(detect[type].test(stream)){if(DEBUG){console.log('suspected '+ type);}
var token=reader[type]();if(token){if(DEBUG){console.log('parsed '+ type,token);}
token.type=token.type||type;token.text=stream.substr(0,token.length);stream=stream.slice(token.length);return token;}
return null;}}};var readTokens=function(handlers){var tok;while((tok=readToken())){if(handlers[tok.type]&&handlers[tok.type](tok)===false){return;}}};var clear=function(){var rest=stream;stream='';return rest;};var rest=function(){return stream;};if(options.fix){(function(){var EMPTY=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i;var CLOSESELF=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i;var stack=[];stack.last=function(){return this[this.length- 1];};stack.lastTagNameEq=function(tagName){var last=this.last();return last&&last.tagName&&last.tagName.toUpperCase()===tagName.toUpperCase();};stack.containsTagName=function(tagName){for(var i=0,tok;(tok=this[i]);i++){if(tok.tagName===tagName){return true;}}
return false;};var correct=function(tok){if(tok&&tok.type==='startTag'){tok.unary=EMPTY.test(tok.tagName)||tok.unary;tok.html5Unary=!/\/>$/.test(tok.text);}
return tok;};var readTokenImpl=readToken;var peekToken=function(){var tmp=stream;var tok=correct(readTokenImpl());stream=tmp;return tok;};var closeLast=function(){var tok=stack.pop();prepend('</'+tok.tagName+'>');};var handlers={startTag:function(tok){var tagName=tok.tagName;if(tagName.toUpperCase()==='TR'&&stack.lastTagNameEq('TABLE')){prepend('<TBODY>');prepareNextToken();}else if(options.fix_selfClose&&CLOSESELF.test(tagName)&&stack.containsTagName(tagName)){if(stack.lastTagNameEq(tagName)){closeLast();}else{prepend('</'+tok.tagName+'>');prepareNextToken();}}else if(!tok.unary){stack.push(tok);}},endTag:function(tok){var last=stack.last();if(last){if(options.fix_tagSoup&&!stack.lastTagNameEq(tok.tagName)){closeLast();}else{stack.pop();}}else if(options.fix_tagSoup){skipToken();}}};var skipToken=function(){readTokenImpl();prepareNextToken();};var prepareNextToken=function(){var tok=peekToken();if(tok&&handlers[tok.type]){handlers[tok.type](tok);}};readToken=function(){prepareNextToken();return correct(readTokenImpl());};})();}
return{append:append,readToken:readToken,readTokens:readTokens,clear:clear,rest:rest,stack:stack};}
htmlParser.supports=supports;htmlParser.tokenToString=function(tok){var handler={comment:function(tok){return'<!--'+ tok.content;},endTag:function(tok){return'</'+tok.tagName+'>';},atomicTag:function(tok){if(DEBUG){console.log(tok);}
return handler.startTag(tok)+
tok.content+
handler.endTag(tok);},startTag:function(tok){var str='<'+tok.tagName;for(var key in tok.attrs){str+=' '+key;var val=tok.attrs[key];if(typeof tok.booleanAttrs=='undefined'||typeof tok.booleanAttrs[key]=='undefined'){str+='="'+(val?val.replace(/(^|[^\\])"/g,'$1\\\"'):'')+'"';}}
if(tok.rest){str+=tok.rest;}
return str+(tok.unary&&!tok.html5Unary?'/>':'>');},chars:function(tok){return tok.text;}};return handler[tok.type](tok);};htmlParser.escapeAttributes=function(attrs){var escapedAttrs={};for(var name in attrs){var value=attrs[name];escapedAttrs[name]=value&&value.replace(/(^|[^\\])"/g,'$1\\\"');}
return escapedAttrs;};for(var key in supports){htmlParser.browserHasFlaw=htmlParser.browserHasFlaw||(!supports[key])&&key;}
this.htmlParser=htmlParser;})();;(function(){function doNothing(){}
var OPTIONS={afterAsync:doNothing,afterDequeue:doNothing,afterStreamStart:doNothing,afterWrite:doNothing,autoFix:true,beforeEnqueue:doNothing,beforeWriteToken:function(tok){return tok;},beforeWrite:function(str){return str;},done:doNothing,error:function(e){throw e;},releaseAsync:false};var global=this;var UNDEFINED=void 0;function existy(thing){return thing!==UNDEFINED&&thing!==null;}
if(global.postscribe){return;}
var DEBUG_CHUNK=false;var slice=Array.prototype.slice;function isFunction(x){return'function'===typeof x;}
function each(arr,fn,_this){var i,len=(arr&&arr.length)||0;for(i=0;i<len;i++){fn.call(_this,arr[i],i);}}
function eachKey(obj,fn,_this){var key;for(key in obj){if(obj.hasOwnProperty(key)){fn.call(_this,key,obj[key]);}}}
function set(obj,props){eachKey(props,function(key,value){obj[key]=value;});return obj;}
function defaults(options,_defaults){options=options||{};eachKey(_defaults,function(key,val){if(!existy(options[key])){options[key]=val;}});return options;}
function toArray(obj){try{return slice.call(obj);}catch(e){var ret=[];each(obj,function(val){ret.push(val);});return ret;}}
var last=function(array){return array[array.length- 1];};function isScript(tok){return!tok||!('tagName'in tok)?!1:!!~tok.tagName.toLowerCase().indexOf('script');}
function isStyle(tok){return!tok||!('tagName'in tok)?!1:!!~tok.tagName.toLowerCase().indexOf('style');}
var WriteStream=(function(){var BASEATTR='data-ps-';function data(el,name,value){var attr=BASEATTR+ name;if(arguments.length===2){var val=el.getAttribute(attr);return!existy(val)?val:String(val);}else if(existy(value)&&value!==''){el.setAttribute(attr,value);}else{el.removeAttribute(attr);}}
function WriteStream(root,options){var doc=root.ownerDocument;set(this,{root:root,options:options,win:doc.defaultView||doc.parentWindow,doc:doc,parser:htmlParser('',{autoFix:options.autoFix}),actuals:[root],proxyHistory:'',proxyRoot:doc.createElement(root.nodeName),scriptStack:[],writeQueue:[]});data(this.proxyRoot,'proxyof',0);}
WriteStream.prototype.write=function(){[].push.apply(this.writeQueue,arguments);var arg;while(!this.deferredRemote&&this.writeQueue.length){arg=this.writeQueue.shift();if(isFunction(arg)){this.callFunction(arg);}else{this.writeImpl(arg);}}};WriteStream.prototype.callFunction=function(fn){var tok={type:'function',value:fn.name||fn.toString()};this.onScriptStart(tok);fn.call(this.win,this.doc);this.onScriptDone(tok);};WriteStream.prototype.writeImpl=function(html){this.parser.append(html);var tok,tokens=[],script,style;while((tok=this.parser.readToken())&&!(script=isScript(tok))&&!(style=isStyle(tok))){tok=this.options.beforeWriteToken(tok);if(tok){tokens.push(tok);}}
this.writeStaticTokens(tokens);if(script){this.handleScriptToken(tok);}
if(style){this.handleStyleToken(tok);}};WriteStream.prototype.writeStaticTokens=function(tokens){var chunk=this.buildChunk(tokens);if(!chunk.actual){return;}
chunk.html=this.proxyHistory+ chunk.actual;this.proxyHistory+=chunk.proxy;this.proxyRoot.innerHTML=chunk.html;if(DEBUG_CHUNK){chunk.proxyInnerHTML=this.proxyRoot.innerHTML;}
this.walkChunk();if(DEBUG_CHUNK){chunk.actualInnerHTML=this.root.innerHTML;}
return chunk;};WriteStream.prototype.buildChunk=function(tokens){var nextId=this.actuals.length,raw=[],actual=[],proxy=[];each(tokens,function(tok){var tokenRaw=htmlParser.tokenToString(tok);raw.push(tokenRaw);if(tok.attrs){if(!(/^noscript$/i).test(tok.tagName)){var id=nextId++;actual.push(tokenRaw.replace(/(\/?>)/,' '+BASEATTR+'id='+id+' $1'));if(tok.attrs.id!=='ps-script'&&tok.attrs.id!=='ps-style'){proxy.push(tok.type==='atomicTag'?'':'<'+tok.tagName+' '+BASEATTR+'proxyof='+id+(tok.unary?' />':'>'));}}}else{actual.push(tokenRaw);proxy.push(tok.type==='endTag'?tokenRaw:'');}});return{tokens:tokens,raw:raw.join(''),actual:actual.join(''),proxy:proxy.join('')};};WriteStream.prototype.walkChunk=function(){var node,stack=[this.proxyRoot];while(existy(node=stack.shift())){var isElement=node.nodeType===1;var isProxy=isElement&&data(node,'proxyof');if(!isProxy){if(isElement){this.actuals[data(node,'id')]=node;data(node,'id',null);}
var parentIsProxyOf=node.parentNode&&data(node.parentNode,'proxyof');if(parentIsProxyOf){this.actuals[parentIsProxyOf].appendChild(node);}}
stack.unshift.apply(stack,toArray(node.childNodes));}};WriteStream.prototype.handleScriptToken=function(tok){var remainder=this.parser.clear();if(remainder){this.writeQueue.unshift(remainder);}
tok.src=tok.attrs.src||tok.attrs.SRC;tok=this.options.beforeWriteToken(tok);if(!tok){return;}
if(tok.src&&this.scriptStack.length){this.deferredRemote=tok;}else{this.onScriptStart(tok);}
var _this=this;this.writeScriptToken(tok,function(){_this.onScriptDone(tok);});};WriteStream.prototype.handleStyleToken=function(tok){var remainder=this.parser.clear();if(remainder){this.writeQueue.unshift(remainder);}
tok.type=tok.attrs.type||tok.attrs.TYPE||'text/css';tok=this.options.beforeWriteToken(tok);if(tok){this.writeStyleToken(tok);}
if(remainder){this.write();}};WriteStream.prototype.writeStyleToken=function(tok){var el=this.buildStyle(tok);this.insertStyle(el);if(tok.content){if(el.styleSheet&&!el.sheet){el.styleSheet.cssText=tok.content;}
else{el.appendChild(this.doc.createTextNode(tok.content));}}};WriteStream.prototype.buildStyle=function(tok){var el=this.doc.createElement(tok.tagName);el.setAttribute('type',tok.type);eachKey(tok.attrs,function(name,value){el.setAttribute(name,value);});return el;};WriteStream.prototype.insertStyle=function(el){this.writeImpl('<span id="ps-style"/>');var cursor=this.doc.getElementById('ps-style');cursor.parentNode.replaceChild(el,cursor);};WriteStream.prototype.onScriptStart=function(tok){tok.outerWrites=this.writeQueue;this.writeQueue=[];this.scriptStack.unshift(tok);};WriteStream.prototype.onScriptDone=function(tok){if(tok!==this.scriptStack[0]){this.options.error({message:'Bad script nesting or script finished twice'});return;}
this.scriptStack.shift();this.write.apply(this,tok.outerWrites);if(!this.scriptStack.length&&this.deferredRemote){this.onScriptStart(this.deferredRemote);this.deferredRemote=null;}};WriteStream.prototype.writeScriptToken=function(tok,done){var el=this.buildScript(tok);var asyncRelease=this.shouldRelease(el);var afterAsync=this.options.afterAsync;if(tok.src){el.src=tok.src;this.scriptLoadHandler(el,!asyncRelease?function(){done();afterAsync();}:afterAsync);}
try{this.insertScript(el);if(!tok.src||asyncRelease){done();}}catch(e){this.options.error(e);done();}};WriteStream.prototype.buildScript=function(tok){var el=this.doc.createElement(tok.tagName);eachKey(tok.attrs,function(name,value){el.setAttribute(name,value);});if(tok.content){el.text=tok.content;}
return el;};WriteStream.prototype.insertScript=function(el){this.writeImpl('<span id="ps-script"/>');var cursor=this.doc.getElementById('ps-script');cursor.parentNode.replaceChild(el,cursor);};WriteStream.prototype.scriptLoadHandler=function(el,done){function cleanup(){el=el.onload=el.onreadystatechange=el.onerror=null;}
var error=this.options.error;function success(){cleanup();done();}
function failure(err){cleanup();error(err);done();}
set(el,{onload:function(){success();},onreadystatechange:function(){if(/^(loaded|complete)$/.test(el.readyState)){success();}},onerror:function(){failure({message:'remote script failed '+ el.src});}});};WriteStream.prototype.shouldRelease=function(el){var isScript=/^script$/i.test(el.nodeName);return!isScript||!!(this.options.releaseAsync&&el.src&&el.hasAttribute('async'));};return WriteStream;}());global.postscribe=(function(){var nextId=0;var queue=[];var active=null;function nextStream(){var args=queue.shift();var options;if(args){options=last(args);options.afterDequeue();args.stream=runStream.apply(null,args);options.afterStreamStart();}}
function runStream(el,html,options){active=new WriteStream(el,options);active.id=nextId++;active.name=options.name||active.id;postscribe.streams[active.name]=active;var doc=el.ownerDocument;var stash={close:doc.close,open:doc.open,write:doc.write,writeln:doc.writeln};function write(str){str=options.beforeWrite(str);active.write(str);options.afterWrite(str);}
set(doc,{close:doNothing,open:doNothing,write:function(){return write(toArray(arguments).join(''));},writeln:function(){return write(toArray(arguments).join('')+'\n');}});var oldOnError=active.win.onerror||doNothing;active.win.onerror=function(msg,url,line){options.error({msg:msg+' - '+ url+':'+ line});oldOnError.apply(active.win,arguments);};active.write(html,function streamDone(){set(doc,stash);active.win.onerror=oldOnError;options.done();active=null;nextStream();});return active;}
function postscribe(el,html,options){if(isFunction(options)){options={done:options};}
options=defaults(options,OPTIONS);el=(/^#/).test(el)?global.document.getElementById(el.substr(1)):el.jquery?el[0]:el;var args=[el,html,options];el.postscribe={cancel:function(){if(args.stream){args.stream.abort();}else{args[1]=doNothing;}}};options.beforeEnqueue(args);queue.push(args);if(!active){nextStream();}
return el.postscribe;}
return set(postscribe,{streams:{},queue:queue,WriteStream:WriteStream});}());}());;(function($){function createCookie(name,value,minutes){if(minutes){var date=new Date();date.setTime(date.getTime()+(minutes*60*1000));var expires="; expires="+date.toGMTString();}else{var expires="";}
document.cookie=name+"="+value+expires;}
function readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);}
return null;}
function eraseCookie(name){createCookie(name,"",-1);}
$('.hamburger-menu').click(function(){$('body').toggleClass('no-scroll');$('.hamburger-menu').toggleClass('open');$('#menuburger').slideToggle(400);});if($('#home-dm').length>0){$('.dm-blocks-news-tiers').parent().addClass('wrapper-news-tiers');}
if(typeof dm_sid!='undefined'){if($.cookie('advpoll'+dm_sid)){$.get("/service/export/sondage/result/"+dm_sid,function(data){$(".dm_sondage_in_article").first().html(data);});}else{$(".dm_sondage_in_article").first().load("/service/export/sondage/form/"+dm_sid);}}
if(jQuery('#custom-calendar').length!=0){var calendar=new Kalendae('custom-calendar',{useYearNav:false,weekStart:1,blackout:function(date){var futureDay=Kalendae.moment().yearDay()<date.yearDay();var weekEnd=[1,0,0,0,0,0,1][Kalendae.moment(date).day()];return(futureDay||weekEnd);}});calendar.subscribe('change',function(){jQuery("#loading").show();jQuery.ajax({type:'GET',url:"editions-pdf/"+(this.getSelected()).replace(/-/g,''),success:function(data){jQuery("#loading").fadeOut(function(){jQuery('#content-pdf').html(data).fadeIn('slow');});return;},error:function(data){jQuery('#content-pdf').html(Drupal.t('Sorry, there is no editions for this date'));}});});}
var screenwidth=$(window).width();if(screenwidth>=1265){$('.header-left .icon-search').hover(function(){$('.header-left .icon-search').toggleClass('open');});}
if(screenwidth<=999&&$('#home-dm').length>0){$(".block-dm-lessentiel").prependTo("#home-dm #main-content");}
$(window).ajaxComplete(function(event,xhr,settings){if($('.alerte-top').length){if(readCookie("directmatinv4-alertband")===null){$('.alerte-top').addClass('open');$('#menuburger').css("top","160px");}
$('.close-alert').click(function(){$('.alerte-top').slideUp(800).hide('slow');$('#menuburger').css("top","100px");if(readCookie("directmatinv4-alertband")===null){createCookie('directmatinv4-alertband','true',30);}});}});$(window).load(function(){if(screenwidth>=999){if($('#home-dm').length>0){var pageheight=$('#home-dm .page').height()+ $('.big-alerte-hp').innerHeight();var heightItems=$('#letop-hp .dm-letop-item:first-child').height();var numItems=$('#letop-hp .dm-letop-item').length;$('#blockLength').css('min-height',heightItems*numItems);var topheight=$('#blockLength').height();if(pageheight>=$('#letop-hp .block-content').outerHeight()){$(window).scroll(function(){var heighttop=$('header').outerHeight()+ $('#alert-band').outerHeight()+ $('#header-post').outerHeight();var heightheader=$('header').outerHeight()+ $('#alert-band').outerHeight()+ $('#header-post').outerHeight()+ $('.big-alerte-hp').innerHeight();var height_content_top=$('#letop-hp .block-content').outerHeight();var pageH=heightheader+ $('#home-dm .page').height()- $(this).height();var pageT=this.scrollY- $('#home-dm .page').offset().top;var scrollPosition=$(this).scrollTop();var top=$('#home-dm .page').height();if(scrollPosition+ $(window).height()<pageheight){$('#letop-hp').css('height','100%');if(scrollPosition>=$('#home-dm .page').offset().top- 24){$('#letop-hp').css("position","fixed").css('top','0');$('.bloc-letop-hp').css('position','relative');}else{$('.bloc-letop-hp').css('position','relative');$('#letop-hp').css("position","absolute").css('top','-20px');}}else{$('#letop-hp').css('position','absolute').css('height',top);$('.bloc-letop-hp').css('position','absolute').css('bottom',0);}
$('#letop-hp').scrollTop(pageT/pageH*($('#blockLength').height()- $(this).height()));});};}}});$(document).ready(function(){if(screenwidth>=1050){if($('.page-news .sidebar-right .block-dm-services').length>0){var heightarticle=$('.page-news .node-dm-article').height();$('.page-news .sidebar-right .block-dm-services').stickit({top:25});$('.page-news .sidebar-right').css('height',heightarticle);}}
$('.outbound_alireaussi > a').click(function(){_gaq.push(['_trackPageview','outbound_alireaussi']);});$('article.node .embed a').click(function(){_gaq.push(['_trackPageview','outbound_surlememesujet']);});$('#letop-hp .dm-letop-main > a').click(function(){_gaq.push(['_trackPageview','outbound_letop_hp']);});$('.sidebar-right .dm-letop-main > a').click(function(){_gaq.push(['_trackPageview','outbound_letop_sidebar']);});$('.page-le-top .dm-letop-main > a').click(function(){_gaq.push(['_trackPageview','outbound_letop_page']);});$('.outbound_pdf_NEP').click(function(){_gaq.push(['_trackPageview','outbound_pdf_NEP']);});$('.outbound_pdf_NP').click(function(){_gaq.push(['_trackPageview','outbound_pdf_NP']);});$('.outbound_pdf_NEP').click(function(){_gaq.push(['_trackPageview','outbound_pdf_NEP']);});$('.outbound_pdf_VP1').click(function(){_gaq.push(['_trackPageview','outbound_pdf_VP1']);});$('.outbound_pdf_SP').click(function(){_gaq.push(['_trackPageview','outbound_pdf_SP']);});$('.outbound_pdf_TP').click(function(){_gaq.push(['_trackPageview','outbound_pdf_TP']);});$('.outbound_pdf_BDX').click(function(){_gaq.push(['_trackPageview','outbound_pdf_BDX']);});$('.outbound_pdf_LIL').click(function(){_gaq.push(['_trackPageview','outbound_pdf_LIL']);});$('.outbound_pdf_LYO').click(function(){_gaq.push(['_trackPageview','outbound_pdf_LYO']);});$('.outbound_pdf_MTP').click(function(){_gaq.push(['_trackPageview','outbound_pdf_MTP']);});$('.outbound_pdf_PRO').click(function(){_gaq.push(['_trackPageview','outbound_pdf_PRO']);});$('.outbound_pdf_JEUX').click(function(){_gaq.push(['_trackPageview','outbound_pdf_JEUX']);});$.smartbanner({title:'CNEWS Matin',price:'Gratuit',appStoreLanguage:'fr',inAppStore:'sur l\'App Store',inGooglePlay:'sur le Google Play',button:'INSTALLER',icon:'/sites/all/themes/directmatinv4/cnewsmatin_logo_mobile.png',appendToSelector:'#wrapper-banner',iOSUniversalApp:true,});if(typeof dm_ads!='undefined'){mobile=get_mobile();if(mobile==false){var locations=$('[class^="dm_ads_"]');OAS_url='http://slot.cnewsmatin.fr/RealMedia/ads/';OAS_sitepage='cnewsmatin.fr';OAS_listpos='Bottom,Middle,Middle1,Top,Top1,Top2';OAS_query='';OAS_target='_top';OAS_version=11;OAS_rn=new String(Math.random());OAS_rns=OAS_rn.substring(2,11);if((navigator.userAgent.indexOf('Mozilla/3')!=-1)||(navigator.userAgent.indexOf('Mozilla/4.0 WebTV')!=-1)){OAS_version=10;}
if(OAS_version>=11){var current_tag=eval('dm_ads_tag');OAS_sitepage+='/'+current_tag;postscribe('#programmatic_ads','<script language=JavaScript1.1 src="'+ OAS_url+'adstream_mjx.ads/'+ OAS_sitepage+'/1'+ OAS_rns+'@'+ OAS_listpos+'?'+ OAS_query+'"><\/script>');}
locations.each(function(index){var div_id=$(this).attr('class');var current_position=div_id.replace('dm_ads_','');if(OAS_listpos.indexOf(current_position)!=-1){postscribe('#'+div_id,'<script>OAS_AD("'+current_position+'");<\/script>');}});}}
var UA=navigator.userAgent;if(UA.match(/iPhone|iPod/i)!=null||UA.match(/iPad/)){$('.btn_sms_ios').each(function(index){$(this).css("display","inline-block");});}else if(UA.match(/Android/i)!=null){$('.btn_sms_android').each(function(index){$(this).css("display","inline-block");});}});})(jQuery);function OAS_AD(pos){if(OAS_version>=11&&typeof(OAS_RICH)!='undefined'){OAS_RICH(pos);}else{document.write('<a href="'+ OAS_url+'click_nx.ads/'+ OAS_sitepage+'/1'+ OAS_rns+'@'+ OAS_listpos+'!'+ pos+'?'+ OAS_query+'" target='+ OAS_target+'>');document.write('<img src="'+ OAS_url+'adstream_nx.ads/'+ OAS_sitepage+'/1'+ OAS_rns+'@'+ OAS_listpos+'!'+ pos+'?'+ OAS_query+'" border=0></A>');}}
function get_mobile(){var UA=navigator.userAgent;var mobile=false;if(UA.match(/Windows Phone 8/i)!=null&&UA.match(/Touch/i)!==null){mobile='windows'}else if(UA.match(/iPhone|iPod/i)!=null||UA.match(/iPad/)){mobile='ios'}else if(UA.match(/\bSilk\/(.*\bMobile Safari\b)?/)||UA.match(/\bKF\w/)||UA.match('Kindle Fire')){mobile='kindle'}else if(UA.match(/Android/i)!=null){mobile='android'}
return mobile;};(function(d){function c(a,b){this.element=d(a);this.lastValues={};d.isArray(b)||(b=[b||{}]);b.length||b.push({});this.optionList=b;var c=this.element.css("transform")||"";this.defaultZIndex=this.element.css("z-index")||100;"auto"==this.defaultZIndex?this.defaultZIndex=100:"0"==this.defaultZIndex&&"none"!=c&&(this.defaultZIndex=100);this.updateOptions();this.lastY=this.offsetY=0;this.stick=e.None;this.spacer=d("<div />");this.spacer[0].id=a.id;this.spacer[0].className=a.className;this.spacer[0].style.cssText=a.style.cssText;this.spacer.addClass("jquery-stickit-spacer");this.spacer[0].style.cssText+=";visibility: hidden !important;display: none !important";this.spacer.insertAfter(this.element);"static"==this.element.parent().css("position")&&this.element.parent().css("position","relative");this.origWillChange=this.element.css("will-change");"auto"==this.origWillChange&&this.element.css("will-change","transform");"none"==c?this.element.css("transform","translateZ(0)"):-1==c.indexOf("matrix3d")&&this.element.css("transform",this.element.css("transform")+" translateZ(0)");this.bound();this.precalculate();this.store()}function m(){n=window.innerHeight||document.documentElement.clientHeight;k=window.innerWidth||document.documentElement.clientWidth;l()}function l(){g=!0;d(":jquery-stickit").each(function(){d(this).data("jquery-stickit").refresh()});setTimeout(function(){g=!1})}function p(){g=!0;d(":jquery-stickit").each(function(){d(this).data("jquery-stickit").locate()});setTimeout(function(){g=!1})}function u(){var a=!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement);d(":jquery-stickit").each(function(){d(this).data("jquery-stickit").enableWillChange(!a)})}function v(a){g||l()}var q=-1!=navigator.userAgent.indexOf("MSIE 7.0"),r=q?-2:0,w=void 0!==window.MutationObserver,h=window.StickScope={Parent:0,Document:1},e={None:0,Fixed:1,Absolute:2},t=!1,g=!1;d.expr[":"]["jquery-stickit"]=function(a){return!!d(a).data("jquery-stickit")};c.prototype.trigger=function(a){var b="on"+a.charAt(0).toUpperCase()+a.slice(1);this.options[b]&&this.options[b].call(this.element);this.element.trigger("stickit:"+a)};c.prototype.isActive=function(a){return(void 0===a.screenMinWidth||k>=a.screenMinWidth)&&(void 0===a.screenMaxWidth||k<=a.screenMaxWidth)};c.prototype.updateCss=function(a){this.element.hasClass(this.options.className)&&a.className!=this.options.className&&this.element.removeClass(this.options.className).addClass(a.className);var b={};this.stick==e.Absolute?this.options.extraHeight!=a.extraHeight&&(b.bottom=-this.options.extraHeight+"px"):this.options.top!=a.top&&(b.top=a.top+this.offsetY+"px");this.options.zIndex!=a.zIndex&&(b.zIndex=this.getZIndex(a));this.element.css(b)};c.prototype.updateOptions=function(){var a=this.getActiveOptionsKey();if(this.activeKey!=a){this.activeKey=a;var b=this.getActiveOptions();this.options&&(a?this.stick!=e.None&&(b.scope==this.options.scope?this.updateCss(b):(this.reset(),setTimeout(this.locate.bind(this)))):this.reset());this.options=b;this.zIndex=this.getZIndex(b)}};c.prototype.getZIndex=function(a){return void 0===a.zIndex?this.defaultZIndex:a.zIndex};c.prototype.getActiveOptionsKey=function(){for(var a=[],b=0;b<this.optionList.length;++b)this.isActive(this.optionList[b])&&a.push(b);return a.join("_")};c.prototype.getActiveOptions=function(){for(var a={},b=0;b<this.optionList.length;++b){var c=this.optionList[b];this.isActive(c)&&d.extend(a,c)}a.scope=a.scope||h.Parent;a.className=a.className||"stick";a.top=a.top||0;a.extraHeight=a.extraHeight||0;void 0===a.overflowScrolling&&(a.overflowScrolling=!0);return a};c.prototype.store=function(){var a=this.element[0];this.origStyle={width:a.style.width,position:a.style.position,left:a.style.left,top:a.style.top,bottom:a.style.bottom,zIndex:a.style.zIndex}};c.prototype.restore=function(){this.element.css(this.origStyle)};c.prototype.bound=function(){var a=this.element;if(q||"border-box"!=a.css("box-sizing"))this.extraWidth=0;else{var b=parseFloat(a.css("border-left-width"))||0,c=parseFloat(a.css("border-right-width"))||0,d=parseFloat(a.css("padding-left"))||0,e=parseFloat(a.css("padding-right"))||0;this.extraWidth=b+c+d+e}this.margin={top:parseFloat(a.css("margin-top"))||0,bottom:parseFloat(a.css("margin-bottom"))||0,left:parseFloat(a.css("margin-left"))||0,right:parseFloat(a.css("margin-right"))||0};this.parent={border:{bottom:parseFloat(a.parent().css("border-bottom-width"))||0}}};c.prototype.precalculate=function(){this.baseTop=this.margin.top+this.options.top;this.basePadding=this.baseTop+this.margin.bottom;this.baseParentOffset=this.options.extraHeight-this.parent.border.bottom;this.offsetHeight=this.options.overflowScrolling?Math.max(this.element.outerHeight(!1)+this.basePadding-n,0):0;this.minOffsetHeight=-this.offsetHeight};c.prototype.reset=function(){this.stick==e.Absolute?(this.trigger("unend"),this.trigger("unstick")):this.stick==e.Fixed&&this.trigger("unstick");this.stick=e.None;this.spacer.css("width",this.origStyle.width);this.spacer[0].style.cssText+=";display: none !important";this.restore();this.element.removeClass(this.options.className)};c.prototype.setAbsolute=function(a){this.stick==e.None&&(this.element.addClass(this.options.className),this.trigger("stick"));this.trigger("end");this.stick=e.Absolute;this.element.css({width:this.element.width()+this.extraWidth+"px",position:"absolute",top:this.origStyle.top,left:a+"px",bottom:-this.options.extraHeight+"px","z-index":this.zIndex})};c.prototype.setFixed=function(a,b,c){this.stick==e.None?(this.element.addClass(this.options.className),this.trigger("stick")):this.trigger("unend");this.options.overflowScrolling||(c=0);this.stick=e.Fixed;this.lastY=b;this.offsetY=c;this.element.css({width:this.element.width()+this.extraWidth+"px",position:"fixed",top:this.options.top+c+"px",left:a+"px",bottom:this.origStyle.bottom,"z-index":this.zIndex})};c.prototype.updateScroll=function(a){if(0!=this.offsetHeight&&this.options.overflowScrolling){var b=Math.max(this.offsetY+a-this.lastY,this.minOffsetHeight),b=Math.min(b,0);this.lastY=a;this.offsetY!=b&&(this.offsetY=b,this.element.css("top",this.options.top+this.offsetY+"px"))}};c.prototype.isHigher=function(){return this.options.scope==h.Parent&&this.element.parent().height()<=this.element.outerHeight(!1)+this.basePadding};c.prototype.locate=function(){if(this.activeKey){var a,b,c,d=this.element,f=this.spacer;switch(this.stick){case e.Fixed:a=f[0].getBoundingClientRect();b=a.top-this.baseTop;0<=b||this.isHigher()?this.reset():this.options.scope==h.Parent?(a=d.parent()[0].getBoundingClientRect(),a.bottom+this.baseParentOffset+this.offsetHeight<=d.outerHeight(!1)+this.basePadding?this.setAbsolute(this.spacer.position().left):this.updateScroll(a.bottom)):this.updateScroll(a.bottom);break;case e.Absolute:a=f[0].getBoundingClientRect();b=a.top-this.baseTop;c=a.left-this.margin.left;0<=b||this.isHigher()?this.reset():(a=d.parent()[0].getBoundingClientRect(),a.bottom+this.baseParentOffset+this.offsetHeight>d.outerHeight(!1)+this.basePadding&&this.setFixed(c+r,a.bottom,-this.offsetHeight));break;default:a=d[0].getBoundingClientRect(),b=a.top-this.baseTop,0<=b||this.isHigher()||(b=d.parent()[0].getBoundingClientRect(),f.height(d.height()),f.show(),c=a.left-this.margin.left,this.options.scope==h.Document?this.setFixed(c,a.bottom,0):b.bottom+this.baseParentOffset+this.offsetHeight<=d.outerHeight(!1)+this.basePadding?this.setAbsolute(this.element.position().left):this.setFixed(c+r,a.bottom,0),f.width()||f.width(d.width()))}}};c.prototype.refresh=function(){this.updateOptions();this.bound();this.precalculate();if(this.stick!=e.None){var a=this.element,b=this.spacer;this.lastValues.width!=b.width()&&a.width(this.lastValues.width=b.width());this.lastValues.height!=a.height()&&b.height(this.lastValues.height=a.height());this.stick==e.Fixed&&(b=this.spacer[0].getBoundingClientRect().left-this.margin.left,this.lastValues.left!=b+"px"&&a.css("left",this.lastValues.left=b+"px"))}this.locate()};c.prototype.destroy=function(){this.reset();this.spacer.remove();this.element.removeData("jquery-stickit")};c.prototype.enableWillChange=function(a){"auto"==this.origWillChange&&this.element.css("will-change",a?"transform":this.origWillChange)};var n,k,x=["destroy","refresh"];d.fn.stickit=function(a,b){if("string"==typeof a){if(-1!=d.inArray(a,x)){var e=arguments;this.each(function(){var b=d(this).data("jquery-stickit");b&&b[a].apply(b,Array.prototype.slice.call(e,1))})}}else t||(t=!0,m(),d(document).ready(function(){d(window).bind("resize",m).bind("scroll",p);d(document.body).bind("animationend webkitAnimationEnd oAnimationEnd transitionend webkitTransitionEnd oTransitionEnd",p);d(document).bind("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",u)}),w&&(new MutationObserver(v)).observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),b=d.isArray(a)?a:Array.prototype.slice.call(arguments,0),this.each(function(){var a=new c(this,b);d(this).data("jquery-stickit",a);a.locate()});return this};d.stickit={refresh:l}})(jQuery);;