var DataLayerProvider=function(){var init=function(t){var e=readCookieFigaro();this.userConnected=e.userConnected,this.isPremium=t&&void 0!==t.isPremium?t.isPremium:null,this.BU_FigCCM2=e.userId,this.BU_userStatus=e.userStatus,this.BU_subscription=e.subscription,this.BU_subscriptionContentState=getSubscriptionContentState.call(this),this.BU_userAgent=getUserAgent(),this.BU_websiteVersion=null,this.BU_orientation=null,this.BU_FigCCM1=getAudienceId(),this.customEvents=!(!t||!t.customEvents)&&t.customEvents,this.customEvents&&document.addEventListener("DOMContentLoaded",pushGTMEvents)},getCookie=function(t){var e,s,i,n=document.cookie.split(";"),r=!1;for(e=0;e<n.length;e++)s=n[e].substr(0,n[e].indexOf("=")),i=n[e].substr(n[e].indexOf("=")+1),(s=s.replace(/^\s+|\s+$/g,""))==t&&(r=decodeURIComponent(i));return r},cookieUnserialize=function(v){if(!v)return null;var s,_un=function(v){s=v;for(var t,e,n,i;s;){switch(s.charAt(0)){case"s":return e=parseInt(s.substr(2,s.indexOf(":")+1)),t=s.substr(s.indexOf(":",2)+2,e),s=s.substr(s.indexOf(";",e+5)+1),t;case"i":return t=parseInt(s.substr(2,s.indexOf(";",2)+1)),s=s.substr(s.indexOf(";")+1),t;case"d":return t=parseFloat(s.substr(2,s.indexOf(";",2))),s=s.substr(s.indexOf(";")+1),t;case"b":return t=s.substr(2,s.indexOf(":")),s=s.substr(s.indexOf(";")+1),!("1"!==t);case"N":return s=s.substr(s.indexOf(";")+1),"";case"a":for(t=[],e=s.indexOf(":",2)-2,n=s.substr(2,e),s=s.substr(s.indexOf("{")+1),i=0;i<n;i++)t[_un(s)]=_un(s);return s=s.substr(s.indexOf("}")+1),t;case"O":default:e=s.indexOf(":",s.indexOf(":",s.indexOf(":")+2)+1)-1,tS="s"+s.substr(s.indexOf(":"),e)+";",o=s;var cN=_un(tS);try{t=eval("new "+cN+"()")}catch(e){t={}}for(s=o.substr(e),n=s.substr(2,s.indexOf(":",2)-2),s=s.substr(s.indexOf("{")+1),i=0;i<n;i++)t[_un(s)]=_un(s);return s=s.substr(s.indexOf("}")+1),t}return""}};return _un(v)},readCookieFigaro=function(){var t=getCookie("figaro_toolbar"),e=cookieUnserialize(t),s=[3,5,6,8,18,19],i=[3,5,6,8,18],n=[19];if(e){var r,u=!1;for(r in s)void 0!==e.roles[i[r]]&&(u=!0),void 0!==e.roles[n[r]]&&!0}return{userConnected:!!e,userId:e?e.uid:"",userStatus:e&&u?"abonne":e?"inscrit":"",subscription:e&&e.roles?Object.keys(e.roles).join("|"):""}},detectWebsiteVersion=function(){return isMobile.phone?"mobile":isMobile.tablet?"tablet":"desktop"},getWebsiteVersion=function(){return"undefined"!=typeof isMobile?detectWebsiteVersion():""},getUserAgent=function(){return window.navigator.userAgent},getSubscriptionContentState=function(){var t="";if(null!==this.isPremium){var e=!this.isPremium||this.isPremium&&"abonne"===this.BU_userStatus,s=this.isPremium&&"abonne"!==this.BU_userStatus;e&&(t="ouvert"),s&&(t="ferme")}return t},getDeviceOrientation=function(){var t=getWebsiteVersion();return"mobile"===t||"tablet"===t?window.innerHeight>window.innerWidth?"portrait":"paysage":""},getAudienceId=function(){var t="";return window.localStorage&&(t=localStorage.getItem("kxkuid")||""),t},getDataBU=function(){return{BU_FigCCM2:this.BU_FigCCM2,BU_userStatus:this.BU_userStatus,BU_subscription:this.BU_subscription,BU_subscriptionContentState:this.BU_subscriptionContentState,BU_userAgent:this.BU_userAgent,BU_websiteVersion:getWebsiteVersion(),BU_orientation:getDeviceOrientation(),BU_FigCCM1:this.BU_FigCCM1}},pushGTMEvents=function(){var t=function(t){var e=t.target.dataset.gtm;void 0!==e&&dataLayer&&dataLayer.push(JSON.parse(e))};document.addEventListener("click",t,!0)};return{init:init,getDataBU:getDataBU}};